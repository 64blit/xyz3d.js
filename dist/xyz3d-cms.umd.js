(function(d,Ue){typeof exports=="object"&&typeof module<"u"?module.exports=Ue(require("three"),require("camera-controls")):typeof define=="function"&&define.amd?define(["three","camera-controls"],Ue):(d=typeof globalThis<"u"?globalThis:d||self,d.XYZ3d=Ue(d._0x558f1c,d._0x385a75))})(this,function(d,Ue){"use strict";function xn(h){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(h){for(const t in h)if(t!=="default"){const n=Object.getOwnPropertyDescriptor(h,t);Object.defineProperty(e,t,n.get?n:{enumerable:!0,get:()=>h[t]})}}return e.default=h,Object.freeze(e)}const Q=xn(d);function Bt(h,e){if(e===d.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),h;if(e===d.TriangleFanDrawMode||e===d.TriangleStripDrawMode){let t=h.getIndex();if(t===null){const r=[],a=h.getAttribute("position");if(a!==void 0){for(let c=0;c<a.count;c++)r.push(c);h.setIndex(r),t=h.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),h}const n=t.count-2,s=[];if(e===d.TriangleFanDrawMode)for(let r=1;r<=n;r++)s.push(t.getX(0)),s.push(t.getX(r)),s.push(t.getX(r+1));else for(let r=0;r<n;r++)r%2===0?(s.push(t.getX(r)),s.push(t.getX(r+1)),s.push(t.getX(r+2))):(s.push(t.getX(r+2)),s.push(t.getX(r+1)),s.push(t.getX(r)));s.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const i=h.clone();return i.setIndex(s),i.clearGroups(),i}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),h}class dn extends d.Loader{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new bn(t)}),this.register(function(t){return new Sn(t)}),this.register(function(t){return new vn(t)}),this.register(function(t){return new Rn(t)}),this.register(function(t){return new An(t)}),this.register(function(t){return new wn(t)}),this.register(function(t){return new yn(t)}),this.register(function(t){return new _n(t)}),this.register(function(t){return new gn(t)}),this.register(function(t){return new En(t)}),this.register(function(t){return new Tn(t)}),this.register(function(t){return new pn(t)}),this.register(function(t){return new In(t)}),this.register(function(t){return new Mn(t)})}load(e,t,n,s){const i=this;let r;this.resourcePath!==""?r=this.resourcePath:this.path!==""?r=this.path:r=d.LoaderUtils.extractUrlBase(e),this.manager.itemStart(e);const a=function(u){s?s(u):console.error(u),i.manager.itemError(e),i.manager.itemEnd(e)},c=new d.FileLoader(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(u){try{i.parse(u,r,function(p){t(p),i.manager.itemEnd(e)},a)}catch(p){a(p)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,s){let i;const r={},a={},c=new TextDecoder;if(typeof e=="string")i=JSON.parse(e);else if(e instanceof ArrayBuffer)if(c.decode(new Uint8Array(e,0,4))===Ht){try{r[J.KHR_BINARY_GLTF]=new Cn(e)}catch(f){s&&s(f);return}i=JSON.parse(r[J.KHR_BINARY_GLTF].content)}else i=JSON.parse(c.decode(e));else i=e;if(i.asset===void 0||i.asset.version[0]<2){s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const u=new jn(i,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});u.fileLoader.setRequestHeader(this.requestHeader);for(let p=0;p<this.pluginCallbacks.length;p++){const f=this.pluginCallbacks[p](u);a[f.name]=f,r[f.name]=!0}if(i.extensionsUsed)for(let p=0;p<i.extensionsUsed.length;++p){const f=i.extensionsUsed[p],g=i.extensionsRequired||[];switch(f){case J.KHR_MATERIALS_UNLIT:r[f]=new mn;break;case J.KHR_DRACO_MESH_COMPRESSION:r[f]=new Ln(i,this.dracoLoader);break;case J.KHR_TEXTURE_TRANSFORM:r[f]=new Nn;break;case J.KHR_MESH_QUANTIZATION:r[f]=new kn;break;default:g.indexOf(f)>=0&&a[f]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+f+'".')}}u.setExtensions(r),u.setPlugins(a),u.parse(n,s)}parseAsync(e,t){const n=this;return new Promise(function(s,i){n.parse(e,t,s,i)})}}function fn(){let h={};return{get:function(e){return h[e]},add:function(e,t){h[e]=t},remove:function(e){delete h[e]},removeAll:function(){h={}}}}const J={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class pn{constructor(e){this.parser=e,this.name=J.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,s=t.length;n<s;n++){const i=t[n];i.extensions&&i.extensions[this.name]&&i.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,i.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let s=t.cache.get(n);if(s)return s;const i=t.json,c=((i.extensions&&i.extensions[this.name]||{}).lights||[])[e];let u;const p=new d.Color(16777215);c.color!==void 0&&p.fromArray(c.color);const f=c.range!==void 0?c.range:0;switch(c.type){case"directional":u=new d.DirectionalLight(p),u.target.position.set(0,0,-1),u.add(u.target);break;case"point":u=new d.PointLight(p),u.distance=f;break;case"spot":u=new d.SpotLight(p),u.distance=f,c.spot=c.spot||{},c.spot.innerConeAngle=c.spot.innerConeAngle!==void 0?c.spot.innerConeAngle:0,c.spot.outerConeAngle=c.spot.outerConeAngle!==void 0?c.spot.outerConeAngle:Math.PI/4,u.angle=c.spot.outerConeAngle,u.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,u.target.position.set(0,0,-1),u.add(u.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return u.position.set(0,0,0),u.decay=2,Fe(u,c),c.intensity!==void 0&&(u.intensity=c.intensity),u.name=t.createUniqueName(c.name||"light_"+e),s=Promise.resolve(u),t.cache.add(n,s),s}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,i=n.json.nodes[e],a=(i.extensions&&i.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(c){return n._getNodeRef(t.cache,a,c)})}}class mn{constructor(){this.name=J.KHR_MATERIALS_UNLIT}getMaterialType(){return d.MeshBasicMaterial}extendParams(e,t,n){const s=[];e.color=new d.Color(1,1,1),e.opacity=1;const i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){const r=i.baseColorFactor;e.color.fromArray(r),e.opacity=r[3]}i.baseColorTexture!==void 0&&s.push(n.assignTexture(e,"map",i.baseColorTexture,d.sRGBEncoding))}return Promise.all(s)}}class gn{constructor(e){this.parser=e,this.name=J.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=s.extensions[this.name].emissiveStrength;return i!==void 0&&(t.emissiveIntensity=i),Promise.resolve()}}class bn{constructor(e){this.parser=e,this.name=J.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:d.MeshPhysicalMaterial}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=[],r=s.extensions[this.name];if(r.clearcoatFactor!==void 0&&(t.clearcoat=r.clearcoatFactor),r.clearcoatTexture!==void 0&&i.push(n.assignTexture(t,"clearcoatMap",r.clearcoatTexture)),r.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=r.clearcoatRoughnessFactor),r.clearcoatRoughnessTexture!==void 0&&i.push(n.assignTexture(t,"clearcoatRoughnessMap",r.clearcoatRoughnessTexture)),r.clearcoatNormalTexture!==void 0&&(i.push(n.assignTexture(t,"clearcoatNormalMap",r.clearcoatNormalTexture)),r.clearcoatNormalTexture.scale!==void 0)){const a=r.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new d.Vector2(a,a)}return Promise.all(i)}}class Tn{constructor(e){this.parser=e,this.name=J.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:d.MeshPhysicalMaterial}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=[],r=s.extensions[this.name];return r.iridescenceFactor!==void 0&&(t.iridescence=r.iridescenceFactor),r.iridescenceTexture!==void 0&&i.push(n.assignTexture(t,"iridescenceMap",r.iridescenceTexture)),r.iridescenceIor!==void 0&&(t.iridescenceIOR=r.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),r.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=r.iridescenceThicknessMinimum),r.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=r.iridescenceThicknessMaximum),r.iridescenceThicknessTexture!==void 0&&i.push(n.assignTexture(t,"iridescenceThicknessMap",r.iridescenceThicknessTexture)),Promise.all(i)}}class An{constructor(e){this.parser=e,this.name=J.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:d.MeshPhysicalMaterial}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=[];t.sheenColor=new d.Color(0,0,0),t.sheenRoughness=0,t.sheen=1;const r=s.extensions[this.name];return r.sheenColorFactor!==void 0&&t.sheenColor.fromArray(r.sheenColorFactor),r.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=r.sheenRoughnessFactor),r.sheenColorTexture!==void 0&&i.push(n.assignTexture(t,"sheenColorMap",r.sheenColorTexture,d.sRGBEncoding)),r.sheenRoughnessTexture!==void 0&&i.push(n.assignTexture(t,"sheenRoughnessMap",r.sheenRoughnessTexture)),Promise.all(i)}}class wn{constructor(e){this.parser=e,this.name=J.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:d.MeshPhysicalMaterial}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=[],r=s.extensions[this.name];return r.transmissionFactor!==void 0&&(t.transmission=r.transmissionFactor),r.transmissionTexture!==void 0&&i.push(n.assignTexture(t,"transmissionMap",r.transmissionTexture)),Promise.all(i)}}class yn{constructor(e){this.parser=e,this.name=J.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:d.MeshPhysicalMaterial}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=[],r=s.extensions[this.name];t.thickness=r.thicknessFactor!==void 0?r.thicknessFactor:0,r.thicknessTexture!==void 0&&i.push(n.assignTexture(t,"thicknessMap",r.thicknessTexture)),t.attenuationDistance=r.attenuationDistance||1/0;const a=r.attenuationColor||[1,1,1];return t.attenuationColor=new d.Color(a[0],a[1],a[2]),Promise.all(i)}}class _n{constructor(e){this.parser=e,this.name=J.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:d.MeshPhysicalMaterial}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=s.extensions[this.name];return t.ior=i.ior!==void 0?i.ior:1.5,Promise.resolve()}}class En{constructor(e){this.parser=e,this.name=J.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:d.MeshPhysicalMaterial}extendMaterialParams(e,t){const n=this.parser,s=n.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=[],r=s.extensions[this.name];t.specularIntensity=r.specularFactor!==void 0?r.specularFactor:1,r.specularTexture!==void 0&&i.push(n.assignTexture(t,"specularIntensityMap",r.specularTexture));const a=r.specularColorFactor||[1,1,1];return t.specularColor=new d.Color(a[0],a[1],a[2]),r.specularColorTexture!==void 0&&i.push(n.assignTexture(t,"specularColorMap",r.specularColorTexture,d.sRGBEncoding)),Promise.all(i)}}class Sn{constructor(e){this.parser=e,this.name=J.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,s=n.textures[e];if(!s.extensions||!s.extensions[this.name])return null;const i=s.extensions[this.name],r=t.options.ktx2Loader;if(!r){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,i.source,r)}}class vn{constructor(e){this.parser=e,this.name=J.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,s=n.json,i=s.textures[e];if(!i.extensions||!i.extensions[t])return null;const r=i.extensions[t],a=s.images[r.source];let c=n.textureLoader;if(a.uri){const u=n.options.manager.getHandler(a.uri);u!==null&&(c=u)}return this.detectSupport().then(function(u){if(u)return n.loadTextureImage(e,r.source,c);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class Rn{constructor(e){this.parser=e,this.name=J.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,s=n.json,i=s.textures[e];if(!i.extensions||!i.extensions[t])return null;const r=i.extensions[t],a=s.images[r.source];let c=n.textureLoader;if(a.uri){const u=n.options.manager.getHandler(a.uri);u!==null&&(c=u)}return this.detectSupport().then(function(u){if(u)return n.loadTextureImage(e,r.source,c);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class In{constructor(e){this.name=J.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const s=n.extensions[this.name],i=this.parser.getDependency("buffer",s.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return i.then(function(a){const c=s.byteOffset||0,u=s.byteLength||0,p=s.count,f=s.byteStride,g=new Uint8Array(a,c,u);return r.decodeGltfBufferAsync?r.decodeGltfBufferAsync(p,f,g,s.mode,s.filter).then(function(y){return y.buffer}):r.ready.then(function(){const y=new ArrayBuffer(p*f);return r.decodeGltfBuffer(new Uint8Array(y),p,f,g,s.mode,s.filter),y})})}else return null}}class Mn{constructor(e){this.name=J.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const s=t.meshes[n.mesh];for(const u of s.primitives)if(u.mode!==Se.TRIANGLES&&u.mode!==Se.TRIANGLE_STRIP&&u.mode!==Se.TRIANGLE_FAN&&u.mode!==void 0)return null;const r=n.extensions[this.name].attributes,a=[],c={};for(const u in r)a.push(this.parser.getDependency("accessor",r[u]).then(p=>(c[u]=p,c[u])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(u=>{const p=u.pop(),f=p.isGroup?p.children:[p],g=u[0].count,y=[];for(const F of f){const H=new d.Matrix4,C=new d.Vector3,k=new d.Quaternion,j=new d.Vector3(1,1,1),I=new d.InstancedMesh(F.geometry,F.material,g);for(let N=0;N<g;N++)c.TRANSLATION&&C.fromBufferAttribute(c.TRANSLATION,N),c.ROTATION&&k.fromBufferAttribute(c.ROTATION,N),c.SCALE&&j.fromBufferAttribute(c.SCALE,N),I.setMatrixAt(N,H.compose(C,k,j));for(const N in c)N!=="TRANSLATION"&&N!=="ROTATION"&&N!=="SCALE"&&F.geometry.setAttribute(N,c[N]);d.Object3D.prototype.copy.call(I,F),I.frustumCulled=!1,this.parser.assignFinalMaterial(I),y.push(I)}return p.isGroup?(p.clear(),p.add(...y),p):y[0]}))}}const Ht="glTF",qe=12,Gt={JSON:1313821514,BIN:5130562};class Cn{constructor(e){this.name=J.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,qe),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==Ht)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const s=this.header.length-qe,i=new DataView(e,qe);let r=0;for(;r<s;){const a=i.getUint32(r,!0);r+=4;const c=i.getUint32(r,!0);if(r+=4,c===Gt.JSON){const u=new Uint8Array(e,qe+r,a);this.content=n.decode(u)}else if(c===Gt.BIN){const u=qe+r;this.body=e.slice(u,u+a)}r+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Ln{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=J.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,s=this.dracoLoader,i=e.extensions[this.name].bufferView,r=e.extensions[this.name].attributes,a={},c={},u={};for(const p in r){const f=Mt[p]||p.toLowerCase();a[f]=r[p]}for(const p in e.attributes){const f=Mt[p]||p.toLowerCase();if(r[p]!==void 0){const g=n.accessors[e.attributes[p]],y=Xe[g.componentType];u[f]=y.name,c[f]=g.normalized===!0}}return t.getDependency("bufferView",i).then(function(p){return new Promise(function(f){s.decodeDracoFile(p,function(g){for(const y in g.attributes){const F=g.attributes[y],H=c[y];H!==void 0&&(F.normalized=H)}f(g)},a,u)})})}}class Nn{constructor(){this.name=J.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return t.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class kn{constructor(){this.name=J.KHR_MESH_QUANTIZATION}}class zt extends d.Interpolant{constructor(e,t,n,s){super(e,t,n,s)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,s=this.valueSize,i=e*s*3+s;for(let r=0;r!==s;r++)t[r]=n[i+r];return t}interpolate_(e,t,n,s){const i=this.resultBuffer,r=this.sampleValues,a=this.valueSize,c=a*2,u=a*3,p=s-t,f=(n-t)/p,g=f*f,y=g*f,F=e*u,H=F-u,C=-2*y+3*g,k=y-g,j=1-C,I=k-g+f;for(let N=0;N!==a;N++){const Y=r[H+N+a],G=r[H+N+c]*p,z=r[F+N+a],A=r[F+N]*p;i[N]=j*Y+I*G+C*z+k*A}return i}}const Dn=new d.Quaternion;class Un extends zt{interpolate_(e,t,n,s){const i=super.interpolate_(e,t,n,s);return Dn.fromArray(i).normalize().toArray(i),i}}const Se={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Xe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},jt={9728:d.NearestFilter,9729:d.LinearFilter,9984:d.NearestMipmapNearestFilter,9985:d.LinearMipmapNearestFilter,9986:d.NearestMipmapLinearFilter,9987:d.LinearMipmapLinearFilter},Zt={33071:d.ClampToEdgeWrapping,33648:d.MirroredRepeatWrapping,10497:d.RepeatWrapping},It={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Mt={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Oe={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},On={CUBICSPLINE:void 0,LINEAR:d.InterpolateLinear,STEP:d.InterpolateDiscrete},Ct={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Fn(h){return h.DefaultMaterial===void 0&&(h.DefaultMaterial=new d.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:d.FrontSide})),h.DefaultMaterial}function Je(h,e,t){for(const n in t.extensions)h[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function Fe(h,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(h.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Pn(h,e,t){let n=!1,s=!1,i=!1;for(let u=0,p=e.length;u<p;u++){const f=e[u];if(f.POSITION!==void 0&&(n=!0),f.NORMAL!==void 0&&(s=!0),f.COLOR_0!==void 0&&(i=!0),n&&s&&i)break}if(!n&&!s&&!i)return Promise.resolve(h);const r=[],a=[],c=[];for(let u=0,p=e.length;u<p;u++){const f=e[u];if(n){const g=f.POSITION!==void 0?t.getDependency("accessor",f.POSITION):h.attributes.position;r.push(g)}if(s){const g=f.NORMAL!==void 0?t.getDependency("accessor",f.NORMAL):h.attributes.normal;a.push(g)}if(i){const g=f.COLOR_0!==void 0?t.getDependency("accessor",f.COLOR_0):h.attributes.color;c.push(g)}}return Promise.all([Promise.all(r),Promise.all(a),Promise.all(c)]).then(function(u){const p=u[0],f=u[1],g=u[2];return n&&(h.morphAttributes.position=p),s&&(h.morphAttributes.normal=f),i&&(h.morphAttributes.color=g),h.morphTargetsRelative=!0,h})}function Bn(h,e){if(h.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)h.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(h.morphTargetInfluences.length===t.length){h.morphTargetDictionary={};for(let n=0,s=t.length;n<s;n++)h.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Hn(h){const e=h.extensions&&h.extensions[J.KHR_DRACO_MESH_COMPRESSION];let t;return e?t="draco:"+e.bufferView+":"+e.indices+":"+Vt(e.attributes):t=h.indices+":"+Vt(h.attributes)+":"+h.mode,t}function Vt(h){let e="";const t=Object.keys(h).sort();for(let n=0,s=t.length;n<s;n++)e+=t[n]+":"+h[t[n]]+";";return e}function Lt(h){switch(h){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Gn(h){return h.search(/\.jpe?g($|\?)/i)>0||h.search(/^data\:image\/jpeg/)===0?"image/jpeg":h.search(/\.webp($|\?)/i)>0||h.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const zn=new d.Matrix4;class jn{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new fn,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,s=!1,i=-1;typeof navigator<"u"&&(n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,s=navigator.userAgent.indexOf("Firefox")>-1,i=s?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||s&&i<98?this.textureLoader=new d.TextureLoader(this.options.manager):this.textureLoader=new d.ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new d.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,s=this.json,i=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(r){return r._markDefs&&r._markDefs()}),Promise.all(this._invokeAll(function(r){return r.beforeRoot&&r.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(r){const a={scene:r[0][s.scene||0],scenes:r[0],animations:r[1],cameras:r[2],asset:s.asset,parser:n,userData:{}};Je(i,a,s),Fe(a,s),Promise.all(n._invokeAll(function(c){return c.afterRoot&&c.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let s=0,i=t.length;s<i;s++){const r=t[s].joints;for(let a=0,c=r.length;a<c;a++)e[r[a]].isBone=!0}for(let s=0,i=e.length;s<i;s++){const r=e[s];r.mesh!==void 0&&(this._addNodeRef(this.meshCache,r.mesh),r.skin!==void 0&&(n[r.mesh].isSkinnedMesh=!0)),r.camera!==void 0&&this._addNodeRef(this.cameraCache,r.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const s=n.clone(),i=(r,a)=>{const c=this.associations.get(r);c!=null&&this.associations.set(a,c);for(const[u,p]of r.children.entries())i(p,a.children[u])};return i(n,s),s.name+="_instance_"+e.uses[t]++,s}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const s=e(t[n]);if(s)return s}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let s=0;s<t.length;s++){const i=e(t[s]);i&&n.push(i)}return n}getDependency(e,t){const n=e+":"+t;let s=this.cache.get(n);if(!s){switch(e){case"scene":s=this.loadScene(t);break;case"node":s=this._invokeOne(function(i){return i.loadNode&&i.loadNode(t)});break;case"mesh":s=this._invokeOne(function(i){return i.loadMesh&&i.loadMesh(t)});break;case"accessor":s=this.loadAccessor(t);break;case"bufferView":s=this._invokeOne(function(i){return i.loadBufferView&&i.loadBufferView(t)});break;case"buffer":s=this.loadBuffer(t);break;case"material":s=this._invokeOne(function(i){return i.loadMaterial&&i.loadMaterial(t)});break;case"texture":s=this._invokeOne(function(i){return i.loadTexture&&i.loadTexture(t)});break;case"skin":s=this.loadSkin(t);break;case"animation":s=this._invokeOne(function(i){return i.loadAnimation&&i.loadAnimation(t)});break;case"camera":s=this.loadCamera(t);break;default:if(s=this._invokeOne(function(i){return i!=this&&i.getDependency&&i.getDependency(e,t)}),!s)throw new Error("Unknown type: "+e);break}this.cache.add(n,s)}return s}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,s=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(s.map(function(i,r){return n.getDependency(e,r)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[J.KHR_BINARY_GLTF].body);const s=this.options;return new Promise(function(i,r){n.load(d.LoaderUtils.resolveURL(t.uri,s.path),i,void 0,function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const s=t.byteLength||0,i=t.byteOffset||0;return n.slice(i,i+s)})}loadAccessor(e){const t=this,n=this.json,s=this.json.accessors[e];if(s.bufferView===void 0&&s.sparse===void 0){const r=It[s.type],a=Xe[s.componentType],c=s.normalized===!0,u=new a(s.count*r);return Promise.resolve(new d.BufferAttribute(u,r,c))}const i=[];return s.bufferView!==void 0?i.push(this.getDependency("bufferView",s.bufferView)):i.push(null),s.sparse!==void 0&&(i.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(i).then(function(r){const a=r[0],c=It[s.type],u=Xe[s.componentType],p=u.BYTES_PER_ELEMENT,f=p*c,g=s.byteOffset||0,y=s.bufferView!==void 0?n.bufferViews[s.bufferView].byteStride:void 0,F=s.normalized===!0;let H,C;if(y&&y!==f){const k=Math.floor(g/y),j="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+k+":"+s.count;let I=t.cache.get(j);I||(H=new u(a,k*y,s.count*y/p),I=new d.InterleavedBuffer(H,y/p),t.cache.add(j,I)),C=new d.InterleavedBufferAttribute(I,c,g%y/p,F)}else a===null?H=new u(s.count*c):H=new u(a,g,s.count*c),C=new d.BufferAttribute(H,c,F);if(s.sparse!==void 0){const k=It.SCALAR,j=Xe[s.sparse.indices.componentType],I=s.sparse.indices.byteOffset||0,N=s.sparse.values.byteOffset||0,Y=new j(r[1],I,s.sparse.count*k),G=new u(r[2],N,s.sparse.count*c);a!==null&&(C=new d.BufferAttribute(C.array.slice(),C.itemSize,C.normalized));for(let z=0,A=Y.length;z<A;z++){const w=Y[z];if(C.setX(w,G[z*c]),c>=2&&C.setY(w,G[z*c+1]),c>=3&&C.setZ(w,G[z*c+2]),c>=4&&C.setW(w,G[z*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return C})}loadTexture(e){const t=this.json,n=this.options,i=t.textures[e].source,r=t.images[i];let a=this.textureLoader;if(r.uri){const c=n.manager.getHandler(r.uri);c!==null&&(a=c)}return this.loadTextureImage(e,i,a)}loadTextureImage(e,t,n){const s=this,i=this.json,r=i.textures[e],a=i.images[t],c=(a.uri||a.bufferView)+":"+r.sampler;if(this.textureCache[c])return this.textureCache[c];const u=this.loadImageSource(t,n).then(function(p){p.flipY=!1,p.name=r.name||a.name||"";const g=(i.samplers||{})[r.sampler]||{};return p.magFilter=jt[g.magFilter]||d.LinearFilter,p.minFilter=jt[g.minFilter]||d.LinearMipmapLinearFilter,p.wrapS=Zt[g.wrapS]||d.RepeatWrapping,p.wrapT=Zt[g.wrapT]||d.RepeatWrapping,s.associations.set(p,{textures:e}),p}).catch(function(){return null});return this.textureCache[c]=u,u}loadImageSource(e,t){const n=this,s=this.json,i=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(f=>f.clone());const r=s.images[e],a=self.URL||self.webkitURL;let c=r.uri||"",u=!1;if(r.bufferView!==void 0)c=n.getDependency("bufferView",r.bufferView).then(function(f){u=!0;const g=new Blob([f],{type:r.mimeType});return c=a.createObjectURL(g),c});else if(r.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const p=Promise.resolve(c).then(function(f){return new Promise(function(g,y){let F=g;t.isImageBitmapLoader===!0&&(F=function(H){const C=new d.Texture(H);C.needsUpdate=!0,g(C)}),t.load(d.LoaderUtils.resolveURL(f,i.path),F,void 0,y)})}).then(function(f){return u===!0&&a.revokeObjectURL(c),f.userData.mimeType=r.mimeType||Gn(r.uri),f}).catch(function(f){throw console.error("THREE.GLTFLoader: Couldn't load texture",c),f});return this.sourceCache[e]=p,p}assignTexture(e,t,n,s){const i=this;return this.getDependency("texture",n.index).then(function(r){if(!r)return null;if(n.texCoord!==void 0&&n.texCoord!=0&&!(t==="aoMap"&&n.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),i.extensions[J.KHR_TEXTURE_TRANSFORM]){const a=n.extensions!==void 0?n.extensions[J.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const c=i.associations.get(r);r=i.extensions[J.KHR_TEXTURE_TRANSFORM].extendTexture(r,a),i.associations.set(r,c)}}return s!==void 0&&(r.encoding=s),e[t]=r,r})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const s=t.attributes.tangent===void 0,i=t.attributes.color!==void 0,r=t.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+n.uuid;let c=this.cache.get(a);c||(c=new d.PointsMaterial,d.Material.prototype.copy.call(c,n),c.color.copy(n.color),c.map=n.map,c.sizeAttenuation=!1,this.cache.add(a,c)),n=c}else if(e.isLine){const a="LineBasicMaterial:"+n.uuid;let c=this.cache.get(a);c||(c=new d.LineBasicMaterial,d.Material.prototype.copy.call(c,n),c.color.copy(n.color),this.cache.add(a,c)),n=c}if(s||i||r){let a="ClonedMaterial:"+n.uuid+":";s&&(a+="derivative-tangents:"),i&&(a+="vertex-colors:"),r&&(a+="flat-shading:");let c=this.cache.get(a);c||(c=n.clone(),i&&(c.vertexColors=!0),r&&(c.flatShading=!0),s&&(c.normalScale&&(c.normalScale.y*=-1),c.clearcoatNormalScale&&(c.clearcoatNormalScale.y*=-1)),this.cache.add(a,c),this.associations.set(c,this.associations.get(n))),n=c}n.aoMap&&t.attributes.uv2===void 0&&t.attributes.uv!==void 0&&t.setAttribute("uv2",t.attributes.uv),e.material=n}getMaterialType(){return d.MeshStandardMaterial}loadMaterial(e){const t=this,n=this.json,s=this.extensions,i=n.materials[e];let r;const a={},c=i.extensions||{},u=[];if(c[J.KHR_MATERIALS_UNLIT]){const f=s[J.KHR_MATERIALS_UNLIT];r=f.getMaterialType(),u.push(f.extendParams(a,i,t))}else{const f=i.pbrMetallicRoughness||{};if(a.color=new d.Color(1,1,1),a.opacity=1,Array.isArray(f.baseColorFactor)){const g=f.baseColorFactor;a.color.fromArray(g),a.opacity=g[3]}f.baseColorTexture!==void 0&&u.push(t.assignTexture(a,"map",f.baseColorTexture,d.sRGBEncoding)),a.metalness=f.metallicFactor!==void 0?f.metallicFactor:1,a.roughness=f.roughnessFactor!==void 0?f.roughnessFactor:1,f.metallicRoughnessTexture!==void 0&&(u.push(t.assignTexture(a,"metalnessMap",f.metallicRoughnessTexture)),u.push(t.assignTexture(a,"roughnessMap",f.metallicRoughnessTexture))),r=this._invokeOne(function(g){return g.getMaterialType&&g.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(g){return g.extendMaterialParams&&g.extendMaterialParams(e,a)})))}i.doubleSided===!0&&(a.side=d.DoubleSide);const p=i.alphaMode||Ct.OPAQUE;if(p===Ct.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,p===Ct.MASK&&(a.alphaTest=i.alphaCutoff!==void 0?i.alphaCutoff:.5)),i.normalTexture!==void 0&&r!==d.MeshBasicMaterial&&(u.push(t.assignTexture(a,"normalMap",i.normalTexture)),a.normalScale=new d.Vector2(1,1),i.normalTexture.scale!==void 0)){const f=i.normalTexture.scale;a.normalScale.set(f,f)}return i.occlusionTexture!==void 0&&r!==d.MeshBasicMaterial&&(u.push(t.assignTexture(a,"aoMap",i.occlusionTexture)),i.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=i.occlusionTexture.strength)),i.emissiveFactor!==void 0&&r!==d.MeshBasicMaterial&&(a.emissive=new d.Color().fromArray(i.emissiveFactor)),i.emissiveTexture!==void 0&&r!==d.MeshBasicMaterial&&u.push(t.assignTexture(a,"emissiveMap",i.emissiveTexture,d.sRGBEncoding)),Promise.all(u).then(function(){const f=new r(a);return i.name&&(f.name=i.name),Fe(f,i),t.associations.set(f,{materials:e}),i.extensions&&Je(s,f,i),f})}createUniqueName(e){const t=d.PropertyBinding.sanitizeNodeName(e||"");let n=t;for(let s=1;this.nodeNamesUsed[n];++s)n=t+"_"+s;return this.nodeNamesUsed[n]=!0,n}loadGeometries(e){const t=this,n=this.extensions,s=this.primitiveCache;function i(a){return n[J.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(c){return Xt(c,a,t)})}const r=[];for(let a=0,c=e.length;a<c;a++){const u=e[a],p=Hn(u),f=s[p];if(f)r.push(f.promise);else{let g;u.extensions&&u.extensions[J.KHR_DRACO_MESH_COMPRESSION]?g=i(u):g=Xt(new d.BufferGeometry,u,t),s[p]={primitive:u,promise:g},r.push(g)}}return Promise.all(r)}loadMesh(e){const t=this,n=this.json,s=this.extensions,i=n.meshes[e],r=i.primitives,a=[];for(let c=0,u=r.length;c<u;c++){const p=r[c].material===void 0?Fn(this.cache):this.getDependency("material",r[c].material);a.push(p)}return a.push(t.loadGeometries(r)),Promise.all(a).then(function(c){const u=c.slice(0,c.length-1),p=c[c.length-1],f=[];for(let y=0,F=p.length;y<F;y++){const H=p[y],C=r[y];let k;const j=u[y];if(C.mode===Se.TRIANGLES||C.mode===Se.TRIANGLE_STRIP||C.mode===Se.TRIANGLE_FAN||C.mode===void 0)k=i.isSkinnedMesh===!0?new d.SkinnedMesh(H,j):new d.Mesh(H,j),k.isSkinnedMesh===!0&&k.normalizeSkinWeights(),C.mode===Se.TRIANGLE_STRIP?k.geometry=Bt(k.geometry,d.TriangleStripDrawMode):C.mode===Se.TRIANGLE_FAN&&(k.geometry=Bt(k.geometry,d.TriangleFanDrawMode));else if(C.mode===Se.LINES)k=new d.LineSegments(H,j);else if(C.mode===Se.LINE_STRIP)k=new d.Line(H,j);else if(C.mode===Se.LINE_LOOP)k=new d.LineLoop(H,j);else if(C.mode===Se.POINTS)k=new d.Points(H,j);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+C.mode);Object.keys(k.geometry.morphAttributes).length>0&&Bn(k,i),k.name=t.createUniqueName(i.name||"mesh_"+e),Fe(k,i),C.extensions&&Je(s,k,C),t.assignFinalMaterial(k),f.push(k)}for(let y=0,F=f.length;y<F;y++)t.associations.set(f[y],{meshes:e,primitives:y});if(f.length===1)return f[0];const g=new d.Group;t.associations.set(g,{meshes:e});for(let y=0,F=f.length;y<F;y++)g.add(f[y]);return g})}loadCamera(e){let t;const n=this.json.cameras[e],s=n[n.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new d.PerspectiveCamera(d.MathUtils.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):n.type==="orthographic"&&(t=new d.OrthographicCamera(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),Fe(t,n),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],n=[];for(let s=0,i=t.joints.length;s<i;s++)n.push(this._loadNodeShallow(t.joints[s]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(s){const i=s.pop(),r=s,a=[],c=[];for(let u=0,p=r.length;u<p;u++){const f=r[u];if(f){a.push(f);const g=new d.Matrix4;i!==null&&g.fromArray(i.array,u*16),c.push(g)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[u])}return new d.Skeleton(a,c)})}loadAnimation(e){const n=this.json.animations[e],s=[],i=[],r=[],a=[],c=[];for(let u=0,p=n.channels.length;u<p;u++){const f=n.channels[u],g=n.samplers[f.sampler],y=f.target,F=y.node,H=n.parameters!==void 0?n.parameters[g.input]:g.input,C=n.parameters!==void 0?n.parameters[g.output]:g.output;s.push(this.getDependency("node",F)),i.push(this.getDependency("accessor",H)),r.push(this.getDependency("accessor",C)),a.push(g),c.push(y)}return Promise.all([Promise.all(s),Promise.all(i),Promise.all(r),Promise.all(a),Promise.all(c)]).then(function(u){const p=u[0],f=u[1],g=u[2],y=u[3],F=u[4],H=[];for(let k=0,j=p.length;k<j;k++){const I=p[k],N=f[k],Y=g[k],G=y[k],z=F[k];if(I===void 0)continue;I.updateMatrix();let A;switch(Oe[z.path]){case Oe.weights:A=d.NumberKeyframeTrack;break;case Oe.rotation:A=d.QuaternionKeyframeTrack;break;case Oe.position:case Oe.scale:default:A=d.VectorKeyframeTrack;break}const w=I.name?I.name:I.uuid,V=G.interpolation!==void 0?On[G.interpolation]:d.InterpolateLinear,P=[];Oe[z.path]===Oe.weights?I.traverse(function(te){te.morphTargetInfluences&&P.push(te.name?te.name:te.uuid)}):P.push(w);let X=Y.array;if(Y.normalized){const te=Lt(X.constructor),se=new Float32Array(X.length);for(let ne=0,re=X.length;ne<re;ne++)se[ne]=X[ne]*te;X=se}for(let te=0,se=P.length;te<se;te++){const ne=new A(P[te]+"."+Oe[z.path],N.array,X,V);G.interpolation==="CUBICSPLINE"&&(ne.createInterpolant=function(me){const ge=this instanceof d.QuaternionKeyframeTrack?Un:zt;return new ge(this.times,this.values,this.getValueSize()/3,me)},ne.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),H.push(ne)}}const C=n.name?n.name:"animation_"+e;return new d.AnimationClip(C,void 0,H)})}createNodeMesh(e){const t=this.json,n=this,s=t.nodes[e];return s.mesh===void 0?null:n.getDependency("mesh",s.mesh).then(function(i){const r=n._getNodeRef(n.meshCache,s.mesh,i);return s.weights!==void 0&&r.traverse(function(a){if(a.isMesh)for(let c=0,u=s.weights.length;c<u;c++)a.morphTargetInfluences[c]=s.weights[c]}),r})}loadNode(e){const t=this.json,n=this,s=t.nodes[e],i=n._loadNodeShallow(e),r=[],a=s.children||[];for(let u=0,p=a.length;u<p;u++)r.push(n.getDependency("node",a[u]));const c=s.skin===void 0?Promise.resolve(null):n.getDependency("skin",s.skin);return Promise.all([i,Promise.all(r),c]).then(function(u){const p=u[0],f=u[1],g=u[2];g!==null&&p.traverse(function(y){y.isSkinnedMesh&&y.bind(g,zn)});for(let y=0,F=f.length;y<F;y++)p.add(f[y]);return p})}_loadNodeShallow(e){const t=this.json,n=this.extensions,s=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const i=t.nodes[e],r=i.name?s.createUniqueName(i.name):"",a=[],c=s._invokeOne(function(u){return u.createNodeMesh&&u.createNodeMesh(e)});return c&&a.push(c),i.camera!==void 0&&a.push(s.getDependency("camera",i.camera).then(function(u){return s._getNodeRef(s.cameraCache,i.camera,u)})),s._invokeAll(function(u){return u.createNodeAttachment&&u.createNodeAttachment(e)}).forEach(function(u){a.push(u)}),this.nodeCache[e]=Promise.all(a).then(function(u){let p;if(i.isBone===!0?p=new d.Bone:u.length>1?p=new d.Group:u.length===1?p=u[0]:p=new d.Object3D,p!==u[0])for(let f=0,g=u.length;f<g;f++)p.add(u[f]);if(i.name&&(p.userData.name=i.name,p.name=r),Fe(p,i),i.extensions&&Je(n,p,i),i.matrix!==void 0){const f=new d.Matrix4;f.fromArray(i.matrix),p.applyMatrix4(f)}else i.translation!==void 0&&p.position.fromArray(i.translation),i.rotation!==void 0&&p.quaternion.fromArray(i.rotation),i.scale!==void 0&&p.scale.fromArray(i.scale);return s.associations.has(p)||s.associations.set(p,{}),s.associations.get(p).nodes=e,p}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],s=this,i=new d.Group;n.name&&(i.name=s.createUniqueName(n.name)),Fe(i,n),n.extensions&&Je(t,i,n);const r=n.nodes||[],a=[];for(let c=0,u=r.length;c<u;c++)a.push(s.getDependency("node",r[c]));return Promise.all(a).then(function(c){for(let p=0,f=c.length;p<f;p++)i.add(c[p]);const u=p=>{const f=new Map;for(const[g,y]of s.associations)(g instanceof d.Material||g instanceof d.Texture)&&f.set(g,y);return p.traverse(g=>{const y=s.associations.get(g);y!=null&&f.set(g,y)}),f};return s.associations=u(i),i})}}function Zn(h,e,t){const n=e.attributes,s=new d.Box3;if(n.POSITION!==void 0){const a=t.json.accessors[n.POSITION],c=a.min,u=a.max;if(c!==void 0&&u!==void 0){if(s.set(new d.Vector3(c[0],c[1],c[2]),new d.Vector3(u[0],u[1],u[2])),a.normalized){const p=Lt(Xe[a.componentType]);s.min.multiplyScalar(p),s.max.multiplyScalar(p)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const i=e.targets;if(i!==void 0){const a=new d.Vector3,c=new d.Vector3;for(let u=0,p=i.length;u<p;u++){const f=i[u];if(f.POSITION!==void 0){const g=t.json.accessors[f.POSITION],y=g.min,F=g.max;if(y!==void 0&&F!==void 0){if(c.setX(Math.max(Math.abs(y[0]),Math.abs(F[0]))),c.setY(Math.max(Math.abs(y[1]),Math.abs(F[1]))),c.setZ(Math.max(Math.abs(y[2]),Math.abs(F[2]))),g.normalized){const H=Lt(Xe[g.componentType]);c.multiplyScalar(H)}a.max(c)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(a)}h.boundingBox=s;const r=new d.Sphere;s.getCenter(r.center),r.radius=s.min.distanceTo(s.max)/2,h.boundingSphere=r}function Xt(h,e,t){const n=e.attributes,s=[];function i(r,a){return t.getDependency("accessor",r).then(function(c){h.setAttribute(a,c)})}for(const r in n){const a=Mt[r]||r.toLowerCase();a in h.attributes||s.push(i(n[r],a))}if(e.indices!==void 0&&!h.index){const r=t.getDependency("accessor",e.indices).then(function(a){h.setIndex(a)});s.push(r)}return Fe(h,e),Zn(h,e,t),Promise.all(s).then(function(){return e.targets!==void 0?Pn(h,e.targets,t):h})}const Nt=new WeakMap;class Vn extends d.Loader{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,s){const i=new d.FileLoader(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,r=>{this.parse(r,t,s)},n,s)}parse(e,t,n){this.decodeDracoFile(e,t,null,null,d.SRGBColorSpace).catch(n)}decodeDracoFile(e,t,n,s,i=d.LinearSRGBColorSpace){const r={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:s||this.defaultAttributeTypes,useUniqueIDs:!!n,vertexColorSpace:i};return this.decodeGeometry(e,r).then(t)}decodeGeometry(e,t){const n=JSON.stringify(t);if(Nt.has(e)){const c=Nt.get(e);if(c.key===n)return c.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let s;const i=this.workerNextTaskID++,r=e.byteLength,a=this._getWorker(i,r).then(c=>(s=c,new Promise((u,p)=>{s._callbacks[i]={resolve:u,reject:p},s.postMessage({type:"decode",id:i,taskConfig:t,buffer:e},[e])}))).then(c=>this._createGeometry(c.geometry));return a.catch(()=>!0).then(()=>{s&&i&&this._releaseTask(s,i)}),Nt.set(e,{key:n,promise:a}),a}_createGeometry(e){const t=new d.BufferGeometry;e.index&&t.setIndex(new d.BufferAttribute(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const s=e.attributes[n],i=s.name,r=s.array,a=s.itemSize,c=new d.BufferAttribute(r,a);i==="color"&&this._assignVertexColorSpace(c,s.vertexColorSpace),t.setAttribute(i,c)}return t}_assignVertexColorSpace(e,t){if(t!==d.SRGBColorSpace)return;const n=new d.Color;for(let s=0,i=e.count;s<i;s++)n.fromBufferAttribute(e,s).convertSRGBToLinear(),e.setXYZ(s,n.r,n.g,n.b)}_loadLibrary(e,t){const n=new d.FileLoader(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((s,i)=>{n.load(e,s,void 0,i)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(n=>{const s=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const i=Xn.toString(),r=["/* draco decoder */",s,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([r]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const s=new Worker(this.workerSourceURL);s._callbacks={},s._taskCosts={},s._taskLoad=0,s.postMessage({type:"init",decoderConfig:this.decoderConfig}),s.onmessage=function(i){const r=i.data;switch(r.type){case"decode":s._callbacks[r.id].resolve(r);break;case"error":s._callbacks[r.id].reject(r);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+r.type+'"')}},this.workerPool.push(s)}else this.workerPool.sort(function(s,i){return s._taskLoad>i._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function Xn(){let h,e;onmessage=function(r){const a=r.data;switch(a.type){case"init":h=a.decoderConfig,e=new Promise(function(p){h.onModuleLoaded=function(f){p({draco:f})},DracoDecoderModule(h)});break;case"decode":const c=a.buffer,u=a.taskConfig;e.then(p=>{const f=p.draco,g=new f.Decoder;try{const y=t(f,g,new Int8Array(c),u),F=y.attributes.map(H=>H.array.buffer);y.index&&F.push(y.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:y},F)}catch(y){console.error(y),self.postMessage({type:"error",id:a.id,error:y.message})}finally{f.destroy(g)}});break}};function t(r,a,c,u){const p=u.attributeIDs,f=u.attributeTypes;let g,y;const F=a.GetEncodedGeometryType(c);if(F===r.TRIANGULAR_MESH)g=new r.Mesh,y=a.DecodeArrayToMesh(c,c.byteLength,g);else if(F===r.POINT_CLOUD)g=new r.PointCloud,y=a.DecodeArrayToPointCloud(c,c.byteLength,g);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!y.ok()||g.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+y.error_msg());const H={index:null,attributes:[]};for(const C in p){const k=self[f[C]];let j,I;if(u.useUniqueIDs)I=p[C],j=a.GetAttributeByUniqueId(g,I);else{if(I=a.GetAttributeId(g,r[p[C]]),I===-1)continue;j=a.GetAttribute(g,I)}const N=s(r,a,g,C,k,j);C==="color"&&(N.vertexColorSpace=u.vertexColorSpace),H.attributes.push(N)}return F===r.TRIANGULAR_MESH&&(H.index=n(r,a,g)),r.destroy(g),H}function n(r,a,c){const p=c.num_faces()*3,f=p*4,g=r._malloc(f);a.GetTrianglesUInt32Array(c,f,g);const y=new Uint32Array(r.HEAPF32.buffer,g,p).slice();return r._free(g),{array:y,itemSize:1}}function s(r,a,c,u,p,f){const g=f.num_components(),F=c.num_points()*g,H=F*p.BYTES_PER_ELEMENT,C=i(r,p),k=r._malloc(H);a.GetAttributeDataArrayForAllPoints(c,f,C,H,k);const j=new p(r.HEAPF32.buffer,k,F).slice();return r._free(k),{name:u,array:j,itemSize:g}}function i(r,a){switch(a){case Float32Array:return r.DT_FLOAT32;case Int8Array:return r.DT_INT8;case Int16Array:return r.DT_INT16;case Int32Array:return r.DT_INT32;case Uint8Array:return r.DT_UINT8;case Uint16Array:return r.DT_UINT16;case Uint32Array:return r.DT_UINT32}}}class Kn extends d.DataTextureLoader{constructor(e){super(e),this.type=d.HalfFloatType}parse(e){const a=function(I,N){switch(I){case 1:console.error("THREE.RGBELoader Read Error: "+(N||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(N||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(N||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(N||""))}return-1},f=`
`,g=function(I,N,Y){N=N||1024;let z=I.pos,A=-1,w=0,V="",P=String.fromCharCode.apply(null,new Uint16Array(I.subarray(z,z+128)));for(;0>(A=P.indexOf(f))&&w<N&&z<I.byteLength;)V+=P,w+=P.length,z+=128,P+=String.fromCharCode.apply(null,new Uint16Array(I.subarray(z,z+128)));return-1<A?(Y!==!1&&(I.pos+=w+A+1),V+P.slice(0,A)):!1},y=function(I){const N=/^#\?(\S+)/,Y=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,G=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,z=/^\s*FORMAT=(\S+)\s*$/,A=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,w={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let V,P;if(I.pos>=I.byteLength||!(V=g(I)))return a(1,"no header found");if(!(P=V.match(N)))return a(3,"bad initial token");for(w.valid|=1,w.programtype=P[1],w.string+=V+`
`;V=g(I),V!==!1;){if(w.string+=V+`
`,V.charAt(0)==="#"){w.comments+=V+`
`;continue}if((P=V.match(Y))&&(w.gamma=parseFloat(P[1])),(P=V.match(G))&&(w.exposure=parseFloat(P[1])),(P=V.match(z))&&(w.valid|=2,w.format=P[1]),(P=V.match(A))&&(w.valid|=4,w.height=parseInt(P[1],10),w.width=parseInt(P[2],10)),w.valid&2&&w.valid&4)break}return w.valid&2?w.valid&4?w:a(3,"missing image size specifier"):a(3,"missing format specifier")},F=function(I,N,Y){const G=N;if(G<8||G>32767||I[0]!==2||I[1]!==2||I[2]&128)return new Uint8Array(I);if(G!==(I[2]<<8|I[3]))return a(3,"wrong scanline width");const z=new Uint8Array(4*N*Y);if(!z.length)return a(4,"unable to allocate buffer space");let A=0,w=0;const V=4*G,P=new Uint8Array(4),X=new Uint8Array(V);let te=Y;for(;te>0&&w<I.byteLength;){if(w+4>I.byteLength)return a(1);if(P[0]=I[w++],P[1]=I[w++],P[2]=I[w++],P[3]=I[w++],P[0]!=2||P[1]!=2||(P[2]<<8|P[3])!=G)return a(3,"bad rgbe scanline format");let se=0,ne;for(;se<V&&w<I.byteLength;){ne=I[w++];const me=ne>128;if(me&&(ne-=128),ne===0||se+ne>V)return a(3,"bad scanline data");if(me){const ge=I[w++];for(let ze=0;ze<ne;ze++)X[se++]=ge}else X.set(I.subarray(w,w+ne),se),se+=ne,w+=ne}const re=G;for(let me=0;me<re;me++){let ge=0;z[A]=X[me+ge],ge+=G,z[A+1]=X[me+ge],ge+=G,z[A+2]=X[me+ge],ge+=G,z[A+3]=X[me+ge],A+=4}te--}return z},H=function(I,N,Y,G){const z=I[N+3],A=Math.pow(2,z-128)/255;Y[G+0]=I[N+0]*A,Y[G+1]=I[N+1]*A,Y[G+2]=I[N+2]*A,Y[G+3]=1},C=function(I,N,Y,G){const z=I[N+3],A=Math.pow(2,z-128)/255;Y[G+0]=d.DataUtils.toHalfFloat(Math.min(I[N+0]*A,65504)),Y[G+1]=d.DataUtils.toHalfFloat(Math.min(I[N+1]*A,65504)),Y[G+2]=d.DataUtils.toHalfFloat(Math.min(I[N+2]*A,65504)),Y[G+3]=d.DataUtils.toHalfFloat(1)},k=new Uint8Array(e);k.pos=0;const j=y(k);if(j!==-1){const I=j.width,N=j.height,Y=F(k.subarray(k.pos),I,N);if(Y!==-1){let G,z,A;switch(this.type){case d.FloatType:A=Y.length/4;const w=new Float32Array(A*4);for(let P=0;P<A;P++)H(Y,P*4,w,P*4);G=w,z=d.FloatType;break;case d.HalfFloatType:A=Y.length/4;const V=new Uint16Array(A*4);for(let P=0;P<A;P++)C(Y,P*4,V,P*4);G=V,z=d.HalfFloatType;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type);break}return{width:I,height:N,data:G,header:j.string,gamma:j.gamma,exposure:j.exposure,type:z}}}return null}setDataType(e){return this.type=e,this}load(e,t,n,s){function i(r,a){switch(r.type){case d.FloatType:case d.HalfFloatType:r.encoding=d.LinearEncoding,r.minFilter=d.LinearFilter,r.magFilter=d.LinearFilter,r.generateMipmaps=!1,r.flipY=!0;break}t&&t(r,a)}return super.load(e,i,n,s)}}/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.6.9
*/var Kt=function(h){return URL.createObjectURL(new Blob([h],{type:"text/javascript"}))};try{URL.revokeObjectURL(Kt(""))}catch{Kt=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)}}var ve=Uint8Array,Pe=Uint16Array,kt=Uint32Array,Wt=new ve([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Yt=new ve([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Wn=new ve([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Qt=function(h,e){for(var t=new Pe(31),n=0;n<31;++n)t[n]=e+=1<<h[n-1];for(var s=new kt(t[30]),n=1;n<30;++n)for(var i=t[n];i<t[n+1];++i)s[i]=i-t[n]<<5|n;return[t,s]},qt=Qt(Wt,2),Jt=qt[0],Yn=qt[1];Jt[28]=258,Yn[258]=28;for(var Qn=Qt(Yt,0),qn=Qn[0],Dt=new Pe(32768),ce=0;ce<32768;++ce){var Be=(ce&43690)>>>1|(ce&21845)<<1;Be=(Be&52428)>>>2|(Be&13107)<<2,Be=(Be&61680)>>>4|(Be&3855)<<4,Dt[ce]=((Be&65280)>>>8|(Be&255)<<8)>>>1}for(var $e=function(h,e,t){for(var n=h.length,s=0,i=new Pe(e);s<n;++s)++i[h[s]-1];var r=new Pe(e);for(s=0;s<e;++s)r[s]=r[s-1]+i[s-1]<<1;var a;if(t){a=new Pe(1<<e);var c=15-e;for(s=0;s<n;++s)if(h[s])for(var u=s<<4|h[s],p=e-h[s],f=r[h[s]-1]++<<p,g=f|(1<<p)-1;f<=g;++f)a[Dt[f]>>>c]=u}else for(a=new Pe(n),s=0;s<n;++s)h[s]&&(a[s]=Dt[r[h[s]-1]++]>>>15-h[s]);return a},et=new ve(288),ce=0;ce<144;++ce)et[ce]=8;for(var ce=144;ce<256;++ce)et[ce]=9;for(var ce=256;ce<280;++ce)et[ce]=7;for(var ce=280;ce<288;++ce)et[ce]=8;for(var $t=new ve(32),ce=0;ce<32;++ce)$t[ce]=5;var Jn=$e(et,9,1),$n=$e($t,5,1),Ut=function(h){for(var e=h[0],t=1;t<h.length;++t)h[t]>e&&(e=h[t]);return e},Me=function(h,e,t){var n=e/8|0;return(h[n]|h[n+1]<<8)>>(e&7)&t},Ot=function(h,e){var t=e/8|0;return(h[t]|h[t+1]<<8|h[t+2]<<16)>>(e&7)},es=function(h){return(h/8|0)+(h&7&&1)},ts=function(h,e,t){(e==null||e<0)&&(e=0),(t==null||t>h.length)&&(t=h.length);var n=new(h instanceof Pe?Pe:h instanceof kt?kt:ve)(t-e);return n.set(h.subarray(e,t)),n},ns=function(h,e,t){var n=h.length;if(!n||t&&!t.l&&n<5)return e||new ve(0);var s=!e||t,i=!t||t.i;t||(t={}),e||(e=new ve(n*3));var r=function(oe){var Ne=e.length;if(oe>Ne){var ke=new ve(Math.max(Ne*2,oe));ke.set(e),e=ke}},a=t.f||0,c=t.p||0,u=t.b||0,p=t.l,f=t.d,g=t.m,y=t.n,F=n*8;do{if(!p){t.f=a=Me(h,c,1);var H=Me(h,c+1,3);if(c+=3,H)if(H==1)p=Jn,f=$n,g=9,y=5;else if(H==2){var I=Me(h,c,31)+257,N=Me(h,c+10,15)+4,Y=I+Me(h,c+5,31)+1;c+=14;for(var G=new ve(Y),z=new ve(19),A=0;A<N;++A)z[Wn[A]]=Me(h,c+A*3,7);c+=N*3;for(var w=Ut(z),V=(1<<w)-1,P=$e(z,w,1),A=0;A<Y;){var X=P[Me(h,c,V)];c+=X&15;var C=X>>>4;if(C<16)G[A++]=C;else{var te=0,se=0;for(C==16?(se=3+Me(h,c,3),c+=2,te=G[A-1]):C==17?(se=3+Me(h,c,7),c+=3):C==18&&(se=11+Me(h,c,127),c+=7);se--;)G[A++]=te}}var ne=G.subarray(0,I),re=G.subarray(I);g=Ut(ne),y=Ut(re),p=$e(ne,g,1),f=$e(re,y,1)}else throw"invalid block type";else{var C=es(c)+4,k=h[C-4]|h[C-3]<<8,j=C+k;if(j>n){if(i)throw"unexpected EOF";break}s&&r(u+k),e.set(h.subarray(C,j),u),t.b=u+=k,t.p=c=j*8;continue}if(c>F){if(i)throw"unexpected EOF";break}}s&&r(u+131072);for(var me=(1<<g)-1,ge=(1<<y)-1,ze=c;;ze=c){var te=p[Ot(h,c)&me],Ae=te>>>4;if(c+=te&15,c>F){if(i)throw"unexpected EOF";break}if(!te)throw"invalid length/literal";if(Ae<256)e[u++]=Ae;else if(Ae==256){ze=c,p=null;break}else{var Ye=Ae-254;if(Ae>264){var A=Ae-257,ye=Wt[A];Ye=Me(h,c,(1<<ye)-1)+Jt[A],c+=ye}var Ze=f[Ot(h,c)&ge],Ve=Ze>>>4;if(!Ze)throw"invalid distance";c+=Ze&15;var re=qn[Ve];if(Ve>3){var ye=Yt[Ve];re+=Ot(h,c)&(1<<ye)-1,c+=ye}if(c>F){if(i)throw"unexpected EOF";break}s&&r(u+131072);for(var it=u+Ye;u<it;u+=4)e[u]=e[u-re],e[u+1]=e[u+1-re],e[u+2]=e[u+2-re],e[u+3]=e[u+3-re];u=it}}t.l=p,t.p=ze,t.b=u,p&&(a=1,t.m=g,t.d=f,t.n=y)}while(!a);return u==e.length?e:ts(e,0,u)},ss=new ve(0),rs=function(h){if((h[0]&15)!=8||h[0]>>>4>7||(h[0]<<8|h[1])%31)throw"invalid zlib data";if(h[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function ht(h,e){return ns((rs(h),h.subarray(2,-4)),e)}var is=typeof TextDecoder<"u"&&new TextDecoder,os=0;try{is.decode(ss,{stream:!0}),os=1}catch{}class as extends d.DataTextureLoader{constructor(e){super(e),this.type=d.HalfFloatType}parse(e){const w=Math.pow(2.7182818,2.2);function V(o,l){let x=0;for(let T=0;T<65536;++T)(T==0||o[T>>3]&1<<(T&7))&&(l[x++]=T);const m=x-1;for(;x<65536;)l[x++]=0;return m}function P(o){for(let l=0;l<16384;l++)o[l]={},o[l].len=0,o[l].lit=0,o[l].p=null}const X={l:0,c:0,lc:0};function te(o,l,x,m,T){for(;x<o;)l=l<<8|un(m,T),x+=8;x-=o,X.l=l>>x&(1<<o)-1,X.c=l,X.lc=x}const se=new Array(59);function ne(o){for(let x=0;x<=58;++x)se[x]=0;for(let x=0;x<65537;++x)se[o[x]]+=1;let l=0;for(let x=58;x>0;--x){const m=l+se[x]>>1;se[x]=l,l=m}for(let x=0;x<65537;++x){const m=o[x];m>0&&(o[x]=m|se[m]++<<6)}}function re(o,l,x,m,T,b){const E=l;let v=0,R=0;for(;m<=T;m++){if(E.value-l.value>x)return!1;te(6,v,R,o,E);const _=X.l;if(v=X.c,R=X.lc,b[m]=_,_==63){if(E.value-l.value>x)throw new Error("Something wrong with hufUnpackEncTable");te(8,v,R,o,E);let S=X.l+6;if(v=X.c,R=X.lc,m+S>T+1)throw new Error("Something wrong with hufUnpackEncTable");for(;S--;)b[m++]=0;m--}else if(_>=59){let S=_-59+2;if(m+S>T+1)throw new Error("Something wrong with hufUnpackEncTable");for(;S--;)b[m++]=0;m--}}ne(b)}function me(o){return o&63}function ge(o){return o>>6}function ze(o,l,x,m){for(;l<=x;l++){const T=ge(o[l]),b=me(o[l]);if(T>>b)throw new Error("Invalid table entry");if(b>14){const E=m[T>>b-14];if(E.len)throw new Error("Invalid table entry");if(E.lit++,E.p){const v=E.p;E.p=new Array(E.lit);for(let R=0;R<E.lit-1;++R)E.p[R]=v[R]}else E.p=new Array(1);E.p[E.lit-1]=l}else if(b){let E=0;for(let v=1<<14-b;v>0;v--){const R=m[(T<<14-b)+E];if(R.len||R.p)throw new Error("Invalid table entry");R.len=b,R.lit=l,E++}}}return!0}const Ae={c:0,lc:0};function Ye(o,l,x,m){o=o<<8|un(x,m),l+=8,Ae.c=o,Ae.lc=l}const ye={c:0,lc:0};function Ze(o,l,x,m,T,b,E,v,R){if(o==l){m<8&&(Ye(x,m,T,b),x=Ae.c,m=Ae.lc),m-=8;let _=x>>m;if(_=new Uint8Array([_])[0],v.value+_>R)return!1;const S=E[v.value-1];for(;_-- >0;)E[v.value++]=S}else if(v.value<R)E[v.value++]=o;else return!1;ye.c=x,ye.lc=m}function Ve(o){return o&65535}function it(o){const l=Ve(o);return l>32767?l-65536:l}const oe={a:0,b:0};function Ne(o,l){const x=it(o),T=it(l),b=x+(T&1)+(T>>1),E=b,v=b-T;oe.a=E,oe.b=v}function ke(o,l){const x=Ve(o),m=Ve(l),T=x-(m>>1)&65535,b=m+T-32768&65535;oe.a=b,oe.b=T}function _s(o,l,x,m,T,b,E){const v=E<16384,R=x>T?T:x;let _=1,S,D;for(;_<=R;)_<<=1;for(_>>=1,S=_,_>>=1;_>=1;){D=0;const L=D+b*(T-S),B=b*_,K=b*S,U=m*_,O=m*S;let W,he,xe,Ee;for(;D<=L;D+=K){let ue=D;const $=D+m*(x-S);for(;ue<=$;ue+=O){const de=ue+U,Ie=ue+B,fe=Ie+U;v?(Ne(o[ue+l],o[Ie+l]),W=oe.a,xe=oe.b,Ne(o[de+l],o[fe+l]),he=oe.a,Ee=oe.b,Ne(W,he),o[ue+l]=oe.a,o[de+l]=oe.b,Ne(xe,Ee),o[Ie+l]=oe.a,o[fe+l]=oe.b):(ke(o[ue+l],o[Ie+l]),W=oe.a,xe=oe.b,ke(o[de+l],o[fe+l]),he=oe.a,Ee=oe.b,ke(W,he),o[ue+l]=oe.a,o[de+l]=oe.b,ke(xe,Ee),o[Ie+l]=oe.a,o[fe+l]=oe.b)}if(x&_){const de=ue+B;v?Ne(o[ue+l],o[de+l]):ke(o[ue+l],o[de+l]),W=oe.a,o[de+l]=oe.b,o[ue+l]=W}}if(T&_){let ue=D;const $=D+m*(x-S);for(;ue<=$;ue+=O){const de=ue+U;v?Ne(o[ue+l],o[de+l]):ke(o[ue+l],o[de+l]),W=oe.a,o[de+l]=oe.b,o[ue+l]=W}}S=_,_>>=1}return D}function Es(o,l,x,m,T,b,E,v,R){let _=0,S=0;const D=E,L=Math.trunc(m.value+(T+7)/8);for(;m.value<L;)for(Ye(_,S,x,m),_=Ae.c,S=Ae.lc;S>=14;){const K=_>>S-14&16383,U=l[K];if(U.len)S-=U.len,Ze(U.lit,b,_,S,x,m,v,R,D),_=ye.c,S=ye.lc;else{if(!U.p)throw new Error("hufDecode issues");let O;for(O=0;O<U.lit;O++){const W=me(o[U.p[O]]);for(;S<W&&m.value<L;)Ye(_,S,x,m),_=Ae.c,S=Ae.lc;if(S>=W&&ge(o[U.p[O]])==(_>>S-W&(1<<W)-1)){S-=W,Ze(U.p[O],b,_,S,x,m,v,R,D),_=ye.c,S=ye.lc;break}}if(O==U.lit)throw new Error("hufDecode issues")}}const B=8-T&7;for(_>>=B,S-=B;S>0;){const K=l[_<<14-S&16383];if(K.len)S-=K.len,Ze(K.lit,b,_,S,x,m,v,R,D),_=ye.c,S=ye.lc;else throw new Error("hufDecode issues")}return!0}function sn(o,l,x,m,T,b){const E={value:0},v=x.value,R=_e(l,x),_=_e(l,x);x.value+=4;const S=_e(l,x);if(x.value+=4,R<0||R>=65537||_<0||_>=65537)throw new Error("Something wrong with HUF_ENCSIZE");const D=new Array(65537),L=new Array(16384);P(L);const B=m-(x.value-v);if(re(o,x,B,R,_,D),S>8*(m-(x.value-v)))throw new Error("Something wrong with hufUncompress");ze(D,R,_,L),Es(D,L,o,x,S,_,b,T,E)}function Ss(o,l,x){for(let m=0;m<x;++m)l[m]=o[l[m]]}function rn(o){for(let l=1;l<o.length;l++){const x=o[l-1]+o[l]-128;o[l]=x}}function on(o,l){let x=0,m=Math.floor((o.length+1)/2),T=0;const b=o.length-1;for(;!(T>b||(l[T++]=o[x++],T>b));)l[T++]=o[m++]}function an(o){let l=o.byteLength;const x=new Array;let m=0;const T=new DataView(o);for(;l>0;){const b=T.getInt8(m++);if(b<0){const E=-b;l-=E+1;for(let v=0;v<E;v++)x.push(T.getUint8(m++))}else{const E=b;l-=2;const v=T.getUint8(m++);for(let R=0;R<E+1;R++)x.push(v)}}return x}function vs(o,l,x,m,T,b){let E=new DataView(b.buffer);const v=x[o.idx[0]].width,R=x[o.idx[0]].height,_=3,S=Math.floor(v/8),D=Math.ceil(v/8),L=Math.ceil(R/8),B=v-(D-1)*8,K=R-(L-1)*8,U={value:0},O=new Array(_),W=new Array(_),he=new Array(_),xe=new Array(_),Ee=new Array(_);for(let $=0;$<_;++$)Ee[$]=l[o.idx[$]],O[$]=$<1?0:O[$-1]+D*L,W[$]=new Float32Array(64),he[$]=new Uint16Array(64),xe[$]=new Uint16Array(D*64);for(let $=0;$<L;++$){let de=8;$==L-1&&(de=K);let Ie=8;for(let ie=0;ie<D;++ie){ie==D-1&&(Ie=B);for(let ae=0;ae<_;++ae)he[ae].fill(0),he[ae][0]=T[O[ae]++],Rs(U,m,he[ae]),Is(he[ae],W[ae]),Ms(W[ae]);Cs(W);for(let ae=0;ae<_;++ae)Ls(W[ae],xe[ae],ie*64)}let fe=0;for(let ie=0;ie<_;++ie){const ae=x[o.idx[ie]].type;for(let De=8*$;De<8*$+de;++De){fe=Ee[ie][De];for(let ut=0;ut<S;++ut){const Le=ut*64+(De&7)*8;E.setUint16(fe+0*2*ae,xe[ie][Le+0],!0),E.setUint16(fe+1*2*ae,xe[ie][Le+1],!0),E.setUint16(fe+2*2*ae,xe[ie][Le+2],!0),E.setUint16(fe+3*2*ae,xe[ie][Le+3],!0),E.setUint16(fe+4*2*ae,xe[ie][Le+4],!0),E.setUint16(fe+5*2*ae,xe[ie][Le+5],!0),E.setUint16(fe+6*2*ae,xe[ie][Le+6],!0),E.setUint16(fe+7*2*ae,xe[ie][Le+7],!0),fe+=8*2*ae}}if(S!=D)for(let De=8*$;De<8*$+de;++De){const ut=Ee[ie][De]+8*S*2*ae,Le=S*64+(De&7)*8;for(let Rt=0;Rt<Ie;++Rt)E.setUint16(ut+Rt*2*ae,xe[ie][Le+Rt],!0)}}}const ue=new Uint16Array(v);E=new DataView(b.buffer);for(let $=0;$<_;++$){x[o.idx[$]].decoded=!0;const de=x[o.idx[$]].type;if(x[$].type==2)for(let Ie=0;Ie<R;++Ie){const fe=Ee[$][Ie];for(let ie=0;ie<v;++ie)ue[ie]=E.getUint16(fe+ie*2*de,!0);for(let ie=0;ie<v;++ie)E.setFloat32(fe+ie*2*de,M(ue[ie]),!0)}}}function Rs(o,l,x){let m,T=1;for(;T<64;)m=l[o.value],m==65280?T=64:m>>8==255?T+=m&255:(x[T]=m,T++),o.value++}function Is(o,l){l[0]=M(o[0]),l[1]=M(o[1]),l[2]=M(o[5]),l[3]=M(o[6]),l[4]=M(o[14]),l[5]=M(o[15]),l[6]=M(o[27]),l[7]=M(o[28]),l[8]=M(o[2]),l[9]=M(o[4]),l[10]=M(o[7]),l[11]=M(o[13]),l[12]=M(o[16]),l[13]=M(o[26]),l[14]=M(o[29]),l[15]=M(o[42]),l[16]=M(o[3]),l[17]=M(o[8]),l[18]=M(o[12]),l[19]=M(o[17]),l[20]=M(o[25]),l[21]=M(o[30]),l[22]=M(o[41]),l[23]=M(o[43]),l[24]=M(o[9]),l[25]=M(o[11]),l[26]=M(o[18]),l[27]=M(o[24]),l[28]=M(o[31]),l[29]=M(o[40]),l[30]=M(o[44]),l[31]=M(o[53]),l[32]=M(o[10]),l[33]=M(o[19]),l[34]=M(o[23]),l[35]=M(o[32]),l[36]=M(o[39]),l[37]=M(o[45]),l[38]=M(o[52]),l[39]=M(o[54]),l[40]=M(o[20]),l[41]=M(o[22]),l[42]=M(o[33]),l[43]=M(o[38]),l[44]=M(o[46]),l[45]=M(o[51]),l[46]=M(o[55]),l[47]=M(o[60]),l[48]=M(o[21]),l[49]=M(o[34]),l[50]=M(o[37]),l[51]=M(o[47]),l[52]=M(o[50]),l[53]=M(o[56]),l[54]=M(o[59]),l[55]=M(o[61]),l[56]=M(o[35]),l[57]=M(o[36]),l[58]=M(o[48]),l[59]=M(o[49]),l[60]=M(o[57]),l[61]=M(o[58]),l[62]=M(o[62]),l[63]=M(o[63])}function Ms(o){const l=.5*Math.cos(.7853975),x=.5*Math.cos(3.14159/16),m=.5*Math.cos(3.14159/8),T=.5*Math.cos(3*3.14159/16),b=.5*Math.cos(5*3.14159/16),E=.5*Math.cos(3*3.14159/8),v=.5*Math.cos(7*3.14159/16),R=new Array(4),_=new Array(4),S=new Array(4),D=new Array(4);for(let L=0;L<8;++L){const B=L*8;R[0]=m*o[B+2],R[1]=E*o[B+2],R[2]=m*o[B+6],R[3]=E*o[B+6],_[0]=x*o[B+1]+T*o[B+3]+b*o[B+5]+v*o[B+7],_[1]=T*o[B+1]-v*o[B+3]-x*o[B+5]-b*o[B+7],_[2]=b*o[B+1]-x*o[B+3]+v*o[B+5]+T*o[B+7],_[3]=v*o[B+1]-b*o[B+3]+T*o[B+5]-x*o[B+7],S[0]=l*(o[B+0]+o[B+4]),S[3]=l*(o[B+0]-o[B+4]),S[1]=R[0]+R[3],S[2]=R[1]-R[2],D[0]=S[0]+S[1],D[1]=S[3]+S[2],D[2]=S[3]-S[2],D[3]=S[0]-S[1],o[B+0]=D[0]+_[0],o[B+1]=D[1]+_[1],o[B+2]=D[2]+_[2],o[B+3]=D[3]+_[3],o[B+4]=D[3]-_[3],o[B+5]=D[2]-_[2],o[B+6]=D[1]-_[1],o[B+7]=D[0]-_[0]}for(let L=0;L<8;++L)R[0]=m*o[16+L],R[1]=E*o[16+L],R[2]=m*o[48+L],R[3]=E*o[48+L],_[0]=x*o[8+L]+T*o[24+L]+b*o[40+L]+v*o[56+L],_[1]=T*o[8+L]-v*o[24+L]-x*o[40+L]-b*o[56+L],_[2]=b*o[8+L]-x*o[24+L]+v*o[40+L]+T*o[56+L],_[3]=v*o[8+L]-b*o[24+L]+T*o[40+L]-x*o[56+L],S[0]=l*(o[L]+o[32+L]),S[3]=l*(o[L]-o[32+L]),S[1]=R[0]+R[3],S[2]=R[1]-R[2],D[0]=S[0]+S[1],D[1]=S[3]+S[2],D[2]=S[3]-S[2],D[3]=S[0]-S[1],o[0+L]=D[0]+_[0],o[8+L]=D[1]+_[1],o[16+L]=D[2]+_[2],o[24+L]=D[3]+_[3],o[32+L]=D[3]-_[3],o[40+L]=D[2]-_[2],o[48+L]=D[1]-_[1],o[56+L]=D[0]-_[0]}function Cs(o){for(let l=0;l<64;++l){const x=o[0][l],m=o[1][l],T=o[2][l];o[0][l]=x+1.5747*T,o[1][l]=x-.1873*m-.4682*T,o[2][l]=x+1.8556*m}}function Ls(o,l,x){for(let m=0;m<64;++m)l[x+m]=d.DataUtils.toHalfFloat(Ns(o[m]))}function Ns(o){return o<=1?Math.sign(o)*Math.pow(Math.abs(o),2.2):Math.sign(o)*Math.pow(w,Math.abs(o)-1)}function cn(o){return new DataView(o.array.buffer,o.offset.value,o.size)}function ks(o){const l=o.viewer.buffer.slice(o.offset.value,o.offset.value+o.size),x=new Uint8Array(an(l)),m=new Uint8Array(x.length);return rn(x),on(x,m),new DataView(m.buffer)}function Pt(o){const l=o.array.slice(o.offset.value,o.offset.value+o.size),x=ht(l),m=new Uint8Array(x.length);return rn(x),on(x,m),new DataView(m.buffer)}function Ds(o){const l=o.viewer,x={value:o.offset.value},m=new Uint16Array(o.width*o.scanlineBlockSize*(o.channels*o.type)),T=new Uint8Array(8192);let b=0;const E=new Array(o.channels);for(let K=0;K<o.channels;K++)E[K]={},E[K].start=b,E[K].end=E[K].start,E[K].nx=o.width,E[K].ny=o.lines,E[K].size=o.type,b+=E[K].nx*E[K].ny*E[K].size;const v=at(l,x),R=at(l,x);if(R>=8192)throw new Error("Something is wrong with PIZ_COMPRESSION BITMAP_SIZE");if(v<=R)for(let K=0;K<R-v+1;K++)T[K+v]=Qe(l,x);const _=new Uint16Array(65536),S=V(T,_),D=_e(l,x);sn(o.array,l,x,D,m,b);for(let K=0;K<o.channels;++K){const U=E[K];for(let O=0;O<E[K].size;++O)_s(m,U.start+O,U.nx,U.size,U.ny,U.nx*U.size,S)}Ss(_,m,b);let L=0;const B=new Uint8Array(m.buffer.byteLength);for(let K=0;K<o.lines;K++)for(let U=0;U<o.channels;U++){const O=E[U],W=O.nx*O.size,he=new Uint8Array(m.buffer,O.end*2,W*2);B.set(he,L),L+=W*2,O.end+=W}return new DataView(B.buffer)}function Us(o){const l=o.array.slice(o.offset.value,o.offset.value+o.size),x=ht(l),m=o.lines*o.channels*o.width,T=o.type==1?new Uint16Array(m):new Uint32Array(m);let b=0,E=0;const v=new Array(4);for(let R=0;R<o.lines;R++)for(let _=0;_<o.channels;_++){let S=0;switch(o.type){case 1:v[0]=b,v[1]=v[0]+o.width,b=v[1]+o.width;for(let D=0;D<o.width;++D){const L=x[v[0]++]<<8|x[v[1]++];S+=L,T[E]=S,E++}break;case 2:v[0]=b,v[1]=v[0]+o.width,v[2]=v[1]+o.width,b=v[2]+o.width;for(let D=0;D<o.width;++D){const L=x[v[0]++]<<24|x[v[1]++]<<16|x[v[2]++]<<8;S+=L,T[E]=S,E++}break}}return new DataView(T.buffer)}function ln(o){const l=o.viewer,x={value:o.offset.value},m=new Uint8Array(o.width*o.lines*(o.channels*o.type*2)),T={version:Re(l,x),unknownUncompressedSize:Re(l,x),unknownCompressedSize:Re(l,x),acCompressedSize:Re(l,x),dcCompressedSize:Re(l,x),rleCompressedSize:Re(l,x),rleUncompressedSize:Re(l,x),rleRawSize:Re(l,x),totalAcUncompressedCount:Re(l,x),totalDcUncompressedCount:Re(l,x),acCompression:Re(l,x)};if(T.version<2)throw new Error("EXRLoader.parse: "+lt.compression+" version "+T.version+" is unsupported");const b=new Array;let E=at(l,x)-2;for(;E>0;){const U=St(l.buffer,x),O=Qe(l,x),W=O>>2&3,he=(O>>4)-1,xe=new Int8Array([he])[0],Ee=Qe(l,x);b.push({name:U,index:xe,type:Ee,compression:W}),E-=U.length+3}const v=lt.channels,R=new Array(o.channels);for(let U=0;U<o.channels;++U){const O=R[U]={},W=v[U];O.name=W.name,O.compression=0,O.decoded=!1,O.type=W.pixelType,O.pLinear=W.pLinear,O.width=o.width,O.height=o.lines}const _={idx:new Array(3)};for(let U=0;U<o.channels;++U){const O=R[U];for(let W=0;W<b.length;++W){const he=b[W];O.name==he.name&&(O.compression=he.compression,he.index>=0&&(_.idx[he.index]=U),O.offset=U)}}let S,D,L;if(T.acCompressedSize>0)switch(T.acCompression){case 0:S=new Uint16Array(T.totalAcUncompressedCount),sn(o.array,l,x,T.acCompressedSize,S,T.totalAcUncompressedCount);break;case 1:const U=o.array.slice(x.value,x.value+T.totalAcUncompressedCount),O=ht(U);S=new Uint16Array(O.buffer),x.value+=T.totalAcUncompressedCount;break}if(T.dcCompressedSize>0){const U={array:o.array,offset:x,size:T.dcCompressedSize};D=new Uint16Array(Pt(U).buffer),x.value+=T.dcCompressedSize}if(T.rleRawSize>0){const U=o.array.slice(x.value,x.value+T.rleCompressedSize),O=ht(U);L=an(O.buffer),x.value+=T.rleCompressedSize}let B=0;const K=new Array(R.length);for(let U=0;U<K.length;++U)K[U]=new Array;for(let U=0;U<o.lines;++U)for(let O=0;O<R.length;++O)K[O].push(B),B+=R[O].width*o.type*2;vs(_,K,R,S,D,m);for(let U=0;U<R.length;++U){const O=R[U];if(!O.decoded)switch(O.compression){case 2:let W=0,he=0;for(let xe=0;xe<o.lines;++xe){let Ee=K[U][W];for(let ue=0;ue<O.width;++ue){for(let $=0;$<2*O.type;++$)m[Ee++]=L[he+$*O.width*O.height];he++}W++}break;case 1:default:throw new Error("EXRLoader.parse: unsupported channel compression")}}return new DataView(m.buffer)}function St(o,l){const x=new Uint8Array(o);let m=0;for(;x[l.value+m]!=0;)m+=1;const T=new TextDecoder().decode(x.slice(l.value,l.value+m));return l.value=l.value+m+1,T}function Os(o,l,x){const m=new TextDecoder().decode(new Uint8Array(o).slice(l.value,l.value+x));return l.value=l.value+x,m}function Fs(o,l){const x=ot(o,l),m=_e(o,l);return[x,m]}function Ps(o,l){const x=_e(o,l),m=_e(o,l);return[x,m]}function ot(o,l){const x=o.getInt32(l.value,!0);return l.value=l.value+4,x}function _e(o,l){const x=o.getUint32(l.value,!0);return l.value=l.value+4,x}function un(o,l){const x=o[l.value];return l.value=l.value+1,x}function Qe(o,l){const x=o.getUint8(l.value);return l.value=l.value+1,x}const Re=function(o,l){let x;return"getBigInt64"in DataView.prototype?x=Number(o.getBigInt64(l.value,!0)):x=o.getUint32(l.value+4,!0)+Number(o.getUint32(l.value,!0)<<32),l.value+=8,x};function be(o,l){const x=o.getFloat32(l.value,!0);return l.value+=4,x}function Bs(o,l){return d.DataUtils.toHalfFloat(be(o,l))}function M(o){const l=(o&31744)>>10,x=o&1023;return(o>>15?-1:1)*(l?l===31?x?NaN:1/0:Math.pow(2,l-15)*(1+x/1024):6103515625e-14*(x/1024))}function at(o,l){const x=o.getUint16(l.value,!0);return l.value+=2,x}function Hs(o,l){return M(at(o,l))}function Gs(o,l,x,m){const T=x.value,b=[];for(;x.value<T+m-1;){const E=St(l,x),v=ot(o,x),R=Qe(o,x);x.value+=3;const _=ot(o,x),S=ot(o,x);b.push({name:E,pixelType:v,pLinear:R,xSampling:_,ySampling:S})}return x.value+=1,b}function zs(o,l){const x=be(o,l),m=be(o,l),T=be(o,l),b=be(o,l),E=be(o,l),v=be(o,l),R=be(o,l),_=be(o,l);return{redX:x,redY:m,greenX:T,greenY:b,blueX:E,blueY:v,whiteX:R,whiteY:_}}function js(o,l){const x=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],m=Qe(o,l);return x[m]}function Zs(o,l){const x=_e(o,l),m=_e(o,l),T=_e(o,l),b=_e(o,l);return{xMin:x,yMin:m,xMax:T,yMax:b}}function Vs(o,l){const x=["INCREASING_Y"],m=Qe(o,l);return x[m]}function Xs(o,l){const x=be(o,l),m=be(o,l);return[x,m]}function Ks(o,l){const x=be(o,l),m=be(o,l),T=be(o,l);return[x,m,T]}function Ws(o,l,x,m,T){if(m==="string"||m==="stringvector"||m==="iccProfile")return Os(l,x,T);if(m==="chlist")return Gs(o,l,x,T);if(m==="chromaticities")return zs(o,x);if(m==="compression")return js(o,x);if(m==="box2i")return Zs(o,x);if(m==="lineOrder")return Vs(o,x);if(m==="float")return be(o,x);if(m==="v2f")return Xs(o,x);if(m==="v3f")return Ks(o,x);if(m==="int")return ot(o,x);if(m==="rational")return Fs(o,x);if(m==="timecode")return Ps(o,x);if(m==="preview")return x.value+=T,"skipped";x.value+=T}function Ys(o,l,x){const m={};if(o.getUint32(0,!0)!=20000630)throw new Error("THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.");m.version=o.getUint8(4);const T=o.getUint8(5);m.spec={singleTile:!!(T&2),longName:!!(T&4),deepFormat:!!(T&8),multiPart:!!(T&16)},x.value=8;let b=!0;for(;b;){const E=St(l,x);if(E==0)b=!1;else{const v=St(l,x),R=_e(o,x),_=Ws(o,l,x,v,R);_===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${v}'.`):m[E]=_}}if(T&-5)throw console.error("EXRHeader:",m),new Error("THREE.EXRLoader: provided file is currently unsupported.");return m}function Qs(o,l,x,m,T){const b={size:0,viewer:l,array:x,offset:m,width:o.dataWindow.xMax-o.dataWindow.xMin+1,height:o.dataWindow.yMax-o.dataWindow.yMin+1,channels:o.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:o.channels[0].pixelType,uncompress:null,getter:null,format:null,encoding:null};switch(o.compression){case"NO_COMPRESSION":b.lines=1,b.uncompress=cn;break;case"RLE_COMPRESSION":b.lines=1,b.uncompress=ks;break;case"ZIPS_COMPRESSION":b.lines=1,b.uncompress=Pt;break;case"ZIP_COMPRESSION":b.lines=16,b.uncompress=Pt;break;case"PIZ_COMPRESSION":b.lines=32,b.uncompress=Ds;break;case"PXR24_COMPRESSION":b.lines=16,b.uncompress=Us;break;case"DWAA_COMPRESSION":b.lines=32,b.uncompress=ln;break;case"DWAB_COMPRESSION":b.lines=256,b.uncompress=ln;break;default:throw new Error("EXRLoader.parse: "+o.compression+" is unsupported")}if(b.scanlineBlockSize=b.lines,b.type==1)switch(T){case d.FloatType:b.getter=Hs,b.inputSize=2;break;case d.HalfFloatType:b.getter=at,b.inputSize=2;break}else if(b.type==2)switch(T){case d.FloatType:b.getter=be,b.inputSize=4;break;case d.HalfFloatType:b.getter=Bs,b.inputSize=4}else throw new Error("EXRLoader.parse: unsupported pixelType "+b.type+" for "+o.compression+".");b.blockCount=(o.dataWindow.yMax+1)/b.scanlineBlockSize;for(let v=0;v<b.blockCount;v++)Re(l,m);b.outputChannels=b.channels==3?4:b.channels;const E=b.width*b.height*b.outputChannels;switch(T){case d.FloatType:b.byteArray=new Float32Array(E),b.channels<b.outputChannels&&b.byteArray.fill(1,0,E);break;case d.HalfFloatType:b.byteArray=new Uint16Array(E),b.channels<b.outputChannels&&b.byteArray.fill(15360,0,E);break;default:console.error("THREE.EXRLoader: unsupported type: ",T);break}return b.bytesPerLine=b.width*b.inputSize*b.channels,b.outputChannels==4?(b.format=d.RGBAFormat,b.encoding=d.LinearEncoding):(b.format=d.RedFormat,b.encoding=d.LinearEncoding),b}const vt=new DataView(e),qs=new Uint8Array(e),ct={value:0},lt=Ys(vt,e,ct),q=Qs(lt,vt,qs,ct,this.type),hn={value:0},Js={R:0,G:1,B:2,A:3,Y:0};for(let o=0;o<q.height/q.scanlineBlockSize;o++){const l=_e(vt,ct);q.size=_e(vt,ct),q.lines=l+q.scanlineBlockSize>q.height?q.height-l:q.scanlineBlockSize;const m=q.size<q.lines*q.bytesPerLine?q.uncompress(q):cn(q);ct.value+=q.size;for(let T=0;T<q.scanlineBlockSize;T++){const b=T+o*q.scanlineBlockSize;if(b>=q.height)break;for(let E=0;E<q.channels;E++){const v=Js[lt.channels[E].name];for(let R=0;R<q.width;R++){hn.value=(T*(q.channels*q.width)+E*q.width+R)*q.inputSize;const _=(q.height-1-b)*(q.width*q.outputChannels)+R*q.outputChannels+v;q.byteArray[_]=q.getter(m,hn)}}}}return{header:lt,width:q.width,height:q.height,data:q.byteArray,format:q.format,encoding:q.encoding,type:this.type}}setDataType(e){return this.type=e,this}load(e,t,n,s){function i(r,a){r.encoding=a.encoding,r.minFilter=d.LinearFilter,r.magFilter=d.LinearFilter,r.generateMipmaps=!1,r.flipY=!1,t&&t(r,a)}return super.load(e,i,n,s)}}const He=xt;(function(h,e){const t=xt,n=h();for(;[];)try{if(parseInt(t(337))/1+-parseInt(t(342))/2+parseInt(t(335))/3+parseInt(t(345))/4*(-parseInt(t(349))/5)+-parseInt(t(341))/6+-parseInt(t(344))/7+-parseInt(t(343))/8*(-parseInt(t(334))/9)===e)break;n.push(n.shift())}catch{n.push(n.shift())}})(dt,160231);function xt(h,e){const t=dt();return xt=function(n,s){return n=n-334,t[n]},xt(h,e)}function dt(){const h=["round","forEach","getRandomIntRange","1532880ypCAOI","109756fXMlLi","765488RFSCNU","995057ztfybv","16IXRQra","getRandomRange","quaternionToVector3","random","79435TWhuze","map","45lukRzH","419568VTKSIC","average","58002gdcoCI"];return dt=function(){return h},dt()}class ft{static[He(346)](e,t){return Math[He(348)]()*(t-e)+e}static[He(340)](e,t){return Math[He(338)](Math.random()*(t-e)+e)}static[He(347)](e,t,n,s){const i=e+e,r=t+t,a=n+n,c=e*r,u=e*a,p=t*a,f=s*i,g=s*r,y=s*a;return{x:c-y,y:p+f,z:u-g}}static[He(350)](e,t,n,s,i){return(e-t)*(i-s)/(n-t)+s}static[He(336)](e){const t=He;let n=0;return e[t(339)](s=>{n+=s}),n/e.length}}function Ge(h,e){const t=pt();return Ge=function(n,s){return n=n-361,t[n]},Ge(h,e)}function pt(){const h=["cameraBounds","Quaternion","name","getAnimations","model","4kUGUBX","130358PNTltw","onHoverAnimations","getSceneZoneByIndex","lookAtTarget","push","raycastTarget","side","getAnimation","getBackgroundModelsByZone","348XzcBcf","wrappedModels","43312ZuuHVn","boxCenter","element","onHover","wrappedSceneZones","2017233JycqcX","Group","getWrappedAnimations","getModel","updateSceneZones","length","userData","looping","forEach","4185110Bcrzaw","visible","30juNVUX","type","index","getCameraAnimationStart","getSceneZoneByName","models","getInteractables","462mfTUlW","interactables","5765hoAHdM","getInteractableModelsByZone","position","wrapScene","camera","loopAnimations","getInteractableObject","lights","getCameraBoundsObject","getRaycastTarget","onClickAnimations","tracks","wrappedAnimations","onClick","99885PpOmzC","getInteractablesByZone","8WReXZM","player","children","getAnimationsFromCSV","getBoundingBox","6952HgyHET","lookAtTargetBox","material","cameraAnimations","values","zone","animations","raycastMesh","bgMesh","getAnimationTrack","interactable","rotation","getCenter","includes","split","Vector3","getPlayer"];return pt=function(){return h},pt()}const ee=Ge;(function(h,e){const t=Ge,n=h();for(;[];)try{if(-parseInt(t(436))/1*(parseInt(t(437))/2)+parseInt(t(407))/3*(-parseInt(t(409))/4)+-parseInt(t(393))/5*(-parseInt(t(384))/6)+parseInt(t(391))/7*(parseInt(t(368))/8)+-parseInt(t(373))/9+parseInt(t(382))/10+-parseInt(t(414))/11*(parseInt(t(366))/12)===e)break;n.push(n.shift())}catch{n.push(n.shift())}})(pt,211829);class cs{constructor(e,t,n){const s=Ge;this.animations=n,this[s(389)]=e,this[s(400)]=t,this[s(367)]={interactables:[],bg:[],player:null},this.wrappedAnimations={looping:[],onClick:[],onHover:[],camera:[]},this[s(372)]=[],this[s(396)](this[s(389)]),this[s(377)](this.wrappedSceneZones)}wrapScene(e){const t=Ge,n={interactables:[],bgMesh:[],player:null},s=[];for(let i=0;i<e.length;i++){const r=e[i],a=r[t(435)].userData;let c={};const u=this[t(434)](a,r[t(433)]);switch(a[t(385)]){case t(424):c=this[t(399)](r,a,u),n[t(392)].push(c);break;case t(431):c=this[t(401)](r,a),s[t(361)](c);break;case t(422):n[t(422)].push(r[t(435)]);break;case t(421):n.bgMesh[t(361)](r[t(435)]);break;case t(410):n.player=r[t(435)];break}}this[t(367)]=n,this.wrappedSceneZones=s}updateSceneZones(e){const t=Ge,n=[...e];for(let s=0;s<n[t(378)];s++){const i=n[s],r=i.position,a=this[t(394)](i[t(419)]);a[t(378)]<=0&&this[t(365)](i[t(419)])[t(381)](g=>{a[t(361)](g)});const c=this.getBoundingBox(a),u=new Q[t(429)];c[t(426)](u);const p=new Q.Vector3;c.getSize(p),n[s][t(369)]=r,n[s][t(415)]=c,n[s].lookAtTargetSize=p,n[s][t(440)]=u}this[t(372)]=n}[ee(439)](e){const t=ee;let n=null;return this[t(372)][t(381)](s=>{s[t(386)]===e&&(n=s)}),n}[ee(388)](e){const t=ee;let n=null,s=null;return this[t(372)][t(381)](i=>{i[t(419)]===e&&(n=i)}),{zoneBox:n,index:s}}getLoopingAnimations(){const e=ee,t={looping:[]};return this[e(405)][e(380)][e(381)](n=>{n.animations.forEach(s=>{t[Ge(380)].push(s)})}),t}[ee(375)](){return this[ee(405)]}[ee(430)](){const e=ee;return this[e(367)][e(410)]}[ee(390)](){const e=ee;return this[e(367)][e(392)]}[ee(408)](e){const t=ee,n=[];for(let s=0;s<this[t(367)][t(392)][t(378)];s++){const i=this[t(367)][t(392)][s];i[t(419)]===e&&n[t(361)](i)}return n}[ee(394)](e){const t=ee,n=[];for(let s=0;s<this[t(367)].interactables[t(378)];s++){const i=this[t(367)][t(392)][s];i[t(419)]===e&&n[t(361)](i[t(370)].model)}return n}getBackgroundModelsByZone(e){const t=ee,n=[];for(let s=0;s<this[t(367)][t(422)][t(378)];s++){const i=this.wrappedModels.bgMesh[s];i[t(385)]===t(374)?i[t(411)].forEach(r=>{const a=t;i[a(379)][a(419)]===e&&n.push(r)}):i[t(379)].zone===e&&n.push(i)}return n}[ee(413)](e){const t=ee,n=new Q.Box3;e[t(385)]==="Group"&&(e=[...e.children]);for(let s=0;s<e.length;s++){const i=e[s];n.expandByObject(i)}return n}[ee(376)](e){const t=ee;for(let n=0;n<this[t(389)][t(378)];n++){const s=this[t(389)][n].model;if(s.name===e)return s}return null}getAnimation(e){const t=ee;for(let n=0;n<this[t(420)][t(378)];n++){const s=this[t(420)][n];if(s[t(433)]===e)return s}return null}[ee(412)](e){const t=ee,n=e[t(428)](","),s=[];for(let i=0;i<n[t(378)];i++){const r=n[i];s[t(361)](this[t(364)](r))}return s}[ee(423)](e,t){const n=ee;for(let s=0;s<e[n(404)][n(378)];s++)if(e[n(404)][s][n(433)]===t)return e[n(404)][s];return null}[ee(387)](e){const t=ee,n={position:null,rotation:null};for(let s=0;s<e[t(397)][t(378)];s++){const i=e[t(397)][s];for(let r=0;r<i.tracks.length;r++){const a=i[t(404)][r];if(a[t(433)][t(427)](".position"))n[t(395)]=new Q[t(429)](a[t(418)][0],a[t(418)][1],a[t(418)][2]);else if(a[t(433)][t(427)](".quaternion")){const c=new Q[t(432)](a[t(418)][0],a[t(418)][1],a[t(418)][2],a[t(418)][3]);n[t(425)]=c}}}return n}[ee(434)](e,t){const n=ee;let s=null,i=null,r=null,a=null;return n(398)in e&&(s=this[n(412)](e.loopAnimations),this[n(405)][n(380)][n(361)]({name:t,animations:s})),n(403)in e&&(i=this.getAnimationsFromCSV(e[n(403)]),this.wrappedAnimations.onClick.push({name:t,animations:i})),n(438)in e&&(r=this[n(412)](e[n(438)]),this[n(405)].onHover[n(361)]({name:t,animations:r})),n(417)in e&&(a=this[n(412)](e[n(417)]),this[n(405)][n(397)][n(361)]({name:t,animations:a})),{loopAnimations:s,onHoverAnimations:r,onClickAnimations:i,cameraAnimations:a}}getInteractableObject(e,t,n){const s=ee,i=this[s(402)](t[s(362)]),r={name:e.name,raycastTarget:i,element:e,animations:{},zone:t.zone};return n[s(438)]!==null&&(r.animations[s(371)]=n[s(438)]),n[s(403)]!==null&&(r[s(420)][s(406)]=n[s(403)]),n[s(417)]!==null&&(r[s(420)][s(397)]=n[s(417)]),r}getCameraBoundsObject(e,t){const n=ee,s={zone:t[n(419)],index:parseInt(t.index,10),position:e.model[n(395)]};return e[n(435)][n(383)]=![],s}getRaycastTarget(e){const t=ee,n=this[t(376)](e);return n==null?(console.log("Missing raycast target for: ",e),null):(n[t(416)][t(363)]=Q.BackSide,n[t(416)][t(383)]=![],n)}}function mt(){const h=["5127237iueVNQ","296AwvGfI","2wPLPmo","949727HPVoeV","4161705YlzIwO","6sIjiVd","2323254nvaQnQ","19432Wotnfw","1273668kXJcFR","10251510pKxQyO","parse"];return mt=function(){return h},mt()}function gt(h,e){const t=mt();return gt=function(n,s){return n=n-381,t[n]},gt(h,e)}const ls=gt;(function(h,e){const t=gt,n=h();for(;[];)try{if(parseInt(t(384))/1*(-parseInt(t(383))/2)+parseInt(t(386))/3*(parseInt(t(389))/4)+parseInt(t(385))/5+parseInt(t(387))/6+-parseInt(t(388))/7*(-parseInt(t(382))/8)+parseInt(t(381))/9+-parseInt(t(390))/10===e)break;n.push(n.shift())}catch{n.push(n.shift())}})(mt,553911);class us{async[ls(391)](e){let t=null;return await fetch(e).then(n=>n.json()).then(n=>{t=n}),t}}const le=je;(function(h,e){const t=je,n=h();for(;[];)try{if(parseInt(t(284))/1+-parseInt(t(230))/2*(-parseInt(t(236))/3)+-parseInt(t(247))/4+parseInt(t(281))/5+parseInt(t(283))/6*(-parseInt(t(229))/7)+parseInt(t(257))/8*(parseInt(t(287))/9)+parseInt(t(205))/10*(parseInt(t(234))/11)===e)break;n.push(n.shift())}catch{n.push(n.shift())}})(bt,859542);function je(h,e){const t=bt();return je=function(n,s){return n=n-186,t[n]},je(h,e)}function bt(){const h=["lights","PMREMGenerator","enableAll","path","EquirectangularReflectionMapping","Mesh","dispose","type","directional","renderer","setDRACOLoader","exr","jsonPath","addPointLight","scene","scale","SpotLight","4790795DVNSph","DEBUG_xyz3d","8446218EPCekl","137921MeOYBv","add","background","1448982kVQdul","loaded","compileEquirectangularShader","addGLTFModel","children","PointLight","Object3D","PointLightHelper","length","mapping","AmbientLight","set","load","sceneWrapper","addLighting",'<iframe id="XYZ3d-fullscreen" src="',"target","getModel","parse","gltfLoader","raycastMesh","gltf children :>> ","processModel","20RpdKFL","name","loadModel","jsonData","setDecoderPath","position","color","addHDR","ambientLight","gltf","intensity","AxesHelper","hdr","DirectionalLightHelper","directionalLight","Vector3","addAmbientLight","content","https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/jsm/libs/draco/","backgroundIntensity","cameraBounds","total","addEXR","interactablesContent","7uhhptg","226jQeGMS","backgroundBlurriness","receiveShadow","An error happened ","2710972cZoOaD","pointLight","23109fxluPN","userData",'"></iframe>',"createLightContainer","iframe","normalBias","modelName","log","light","spot","size","6564640YeBKtD","castShadow","texture","point","quaternion","getHtmlData","addDirectionalLight","createModelContainer","push","models","72XXkgpU","animations","DirectionalLight","setModelMatrixData","rotation","loadJson","lerp"];return bt=function(){return h},bt()}class hs{constructor(e,t,n){const s=je;this[s(278)]=e,this.renderer=t,this.jsonPath=n,this.sceneWrapper;const i=new Vn;if(i[s(209)](s(223)),this[s(201)]=new dn,this[s(201)][s(274)](i),window[s(282)]){const r=new Q[s(216)](5e3);this[s(278)][s(285)](r)}}getSceneWrapper(){return this[je(195)]}async[le(262)](){const e=le;return await new us()[e(200)](this[e(276)])}async build(e){const t=le,n=await this[t(262)](),s=[],i=[],r=await this.addGLTFModel(n[t(256)],e),a=this[t(196)](n[t(264)]);return a[t(255)](...r[t(264)]),s[t(255)](...r[t(256)]),i.push(...r[t(258)]),this.sceneWrapper=new cs(s,a,i),this[t(195)]}async[le(290)](e,t){const n=le,s=[],i=[],r=[];for(let a=0;a<e[n(190)];a++){const c=e[a],u=function(p){const f=n;t(a+1,e[f(190)],100*p[f(288)]/p[f(226)])};await this[n(207)](c,u).then(p=>{const f=n;window[f(282)]&&console.log(f(203),[...p[f(214)].scene[f(186)]]);const g=this[f(204)](p);s.push(...g.models),i[f(255)](...g[f(264)]),r[f(255)](...g[f(258)])})}return{models:s,lights:i,animations:r}}[le(199)](e,t){const n=le;for(let s=0;s<e[n(190)];s++){const i=e[s];if(i[n(206)]===t)return i}return null}createModelContainer(e,t){const n=le,s={name:e[n(206)],model:e};switch(this[n(260)](e,t),e[n(248)]=t[n(248)],e[n(232)]=t[n(232)],e[n(237)].type){case"bgMesh":break;case"interactable":const i=this.getHtml(t,e[n(206)]);s.contentType=i.type,s[n(222)]=i.content;break;case n(202):break;case n(225):break}return s}[le(239)](e,t){return{type:e,light:t}}processModel(e){const t=le,n=[...e[t(214)][t(278)][t(186)]],s=e[t(214)][t(258)],i=[],r=[],a=1e5;for(let c=0;c<n[t(190)];c++){const u=n[c];switch(u.layers[t(266)](),u[t(271)]){case t(269):i.push(this[t(254)](u,e[t(208)]));break;case"Group":u[t(186)].forEach(p=>{const f=t;this[f(260)](p,e[f(208)])}),i[t(255)](this.createModelContainer(u,e[t(208)]));break;case t(188):i[t(255)](this.createModelContainer(u,e[t(208)]));break;case t(187):u[t(215)]/=a,r.push(this[t(239)](t(250),u));break;case t(259):u[t(215)]/=a,r.push(this[t(239)](t(272),u));break;case t(280):u.intensity/=a,r.push(this[t(239)](t(245),u));break;default:console[t(243)](":>> GLTF element unrecognized:",u);break}this[t(278)][t(285)](u)}return{models:i,lights:r,animations:s}}[le(260)](e,t){const n=le;e[n(210)][n(193)](e[n(210)].x+t.position.x,e[n(210)].y+t[n(210)].y,e[n(210)].z+t.position.z),e[n(251)].set(t.rotation.x,t[n(261)].y,t.rotation.z,t.rotation.w),e[n(279)][n(193)](t[n(279)].x,t.scale.y,t[n(279)].z)}getHtml(e,t){const n=le,s=this[n(252)](e,t);if(s[n(222)]!==void 0)return s.type===n(240)&&(s.content=n(197)+s[n(222)]+n(238)),s}getHtmlData(e,t){const n=le,s=e[n(228)];for(let i=0;i<s[n(190)];i++){const r=s[i];if(r[n(242)]===t)return r}return null}async loadModel(e,t){return new Promise(n=>{const s=je;return this[s(201)][s(194)](".."+e[s(267)],function(i){n({gltf:i,jsonData:e})},t,function(i){console.log(s(233)+i)})})}addLighting(e){const t=le,n=[];for(let s=0;s<e[t(190)];s++){const i=e[s];let r,a;const c={type:null,light:null};switch(i[t(271)]){case t(217):this[t(212)](i[t(267)],i.backgroundIntensity,i.backgroundBlurriness);break;case t(275):this[t(227)](i[t(267)],i.backgroundIntensity,i[t(231)]);break;case"pointLight":r=new Q.Vector3(i[t(210)].x,i[t(210)].y,i.position.z),a=this[t(277)](r,i[t(211)],i[t(215)],i[t(246)],i.castShadow),c[t(271)]=t(235),c[t(244)]=a;break;case t(219):r=new Q[t(220)](i[t(210)].x,i[t(210)].y,i[t(210)].z);const u=new Q[t(220)](i.target.x,i[t(198)].y,i[t(198)].z);a=this.addDirectionalLight(r,u,i[t(211)],i[t(215)],i[t(248)]),c.type=t(219),c[t(244)]=a;break;case t(213):a=this.addAmbientLight(i[t(211)],i[t(215)]),c.type=t(213),c.light=a;break}n[t(255)](c)}return n}[le(277)](e,t=0,n=1,s=1500,i=![]){const r=le,a=new Q[r(187)](t,n,s);if(a[r(210)][r(263)](e,1),a[r(248)]=i,a.normalBias=.1,this[r(278)].add(a),window[r(282)]){const c=new Q[r(189)](a,.25);this[r(278)][r(285)](c)}return a}[le(221)](e=0,t=1){const n=le,s=new Q[n(192)](e,t);return this[n(278)][n(285)](s),s}[le(253)](e,t=new Q[le(220)](0,0,0),n=16777215,s=2,i=![]){const r=le,a=new Q[r(259)](n,s);if(a.position[r(263)](e,1),a[r(198)][r(210)][r(263)](t,1),a[r(248)]=i,a[r(241)]=.1,this[r(278)].add(a),this[r(278)].add(a[r(198)]),window[r(282)]){const c=new Q[r(218)](a);this[r(278)][r(285)](c)}return a}addHDR(e,t,n){const s=le,i=new Q[s(265)](this[s(273)]);i[s(289)]();let r;new Kn()[s(194)](".."+e,a=>{const c=s;r=i.fromEquirectangular(a)[c(249)],this[c(278)].environment=r,this.scene.background=r,this.scene[c(224)]=t,this[c(278)][c(231)]=n,a[c(270)](),i[c(270)]()})}[le(227)](e,t,n){const s=le,i=new Q[s(265)](this[s(273)]);i.compileEquirectangularShader();let r;new as()[s(194)](".."+e,a=>{const c=s;a[c(191)]=Q[c(268)],r=i.fromEquirectangular(a).texture,this.scene.environment=r,this.scene[c(286)]=r,this[c(278)][c(224)]=t,this[c(278)][c(231)]=n,a.dispose(),i[c(270)]()})}}class tt{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const xs=new d.OrthographicCamera(-1,1,1,-1,0,1),Ft=new d.BufferGeometry;Ft.setAttribute("position",new d.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),Ft.setAttribute("uv",new d.Float32BufferAttribute([0,2,0,0,2,0],2));class en{constructor(e){this._mesh=new d.Mesh(Ft,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,xs)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}const tn={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			gl_FragColor = texture2D( tDiffuse, vUv );
			gl_FragColor.a *= opacity;


		}`},ds={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new d.Color(0)},defaultOpacity:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform vec3 defaultColor;
		uniform float defaultOpacity;
		uniform float luminosityThreshold;
		uniform float smoothWidth;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );

			vec3 luma = vec3( 0.299, 0.587, 0.114 );

			float v = dot( texel.xyz, luma );

			vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );

			float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );

			gl_FragColor = mix( outputColor, texel, alpha );

		}`};class Ke extends tt{constructor(e,t,n,s){super(),this.strength=t!==void 0?t:1,this.radius=n,this.threshold=s,this.resolution=e!==void 0?new d.Vector2(e.x,e.y):new d.Vector2(256,256),this.clearColor=new d.Color(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let i=Math.round(this.resolution.x/2),r=Math.round(this.resolution.y/2);this.renderTargetBright=new d.WebGLRenderTarget(i,r),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let f=0;f<this.nMips;f++){const g=new d.WebGLRenderTarget(i,r);g.texture.name="UnrealBloomPass.h"+f,g.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(g);const y=new d.WebGLRenderTarget(i,r);y.texture.name="UnrealBloomPass.v"+f,y.texture.generateMipmaps=!1,this.renderTargetsVertical.push(y),i=Math.round(i/2),r=Math.round(r/2)}const a=ds;this.highPassUniforms=d.UniformsUtils.clone(a.uniforms),this.highPassUniforms.luminosityThreshold.value=s,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new d.ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,defines:{}}),this.separableBlurMaterials=[];const c=[3,5,7,9,11];i=Math.round(this.resolution.x/2),r=Math.round(this.resolution.y/2);for(let f=0;f<this.nMips;f++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(c[f])),this.separableBlurMaterials[f].uniforms.texSize.value=new d.Vector2(i,r),i=Math.round(i/2),r=Math.round(r/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;const u=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=u,this.bloomTintColors=[new d.Vector3(1,1,1),new d.Vector3(1,1,1),new d.Vector3(1,1,1),new d.Vector3(1,1,1),new d.Vector3(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors;const p=tn;this.copyUniforms=d.UniformsUtils.clone(p.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new d.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:p.vertexShader,fragmentShader:p.fragmentShader,blending:d.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new d.Color,this.oldClearAlpha=1,this.basic=new d.MeshBasicMaterial,this.fsQuad=new en(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose();for(let e=0;e<this.separableBlurMaterials.length;e++)this.separableBlurMaterials[e].dispose();this.compositeMaterial.dispose(),this.materialCopy.dispose(),this.basic.dispose(),this.fsQuad.dispose()}setSize(e,t){let n=Math.round(e/2),s=Math.round(t/2);this.renderTargetBright.setSize(n,s);for(let i=0;i<this.nMips;i++)this.renderTargetsHorizontal[i].setSize(n,s),this.renderTargetsVertical[i].setSize(n,s),this.separableBlurMaterials[i].uniforms.texSize.value=new d.Vector2(n,s),n=Math.round(n/2),s=Math.round(s/2)}render(e,t,n,s,i){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const r=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),i&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=n.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=n.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let a=this.renderTargetBright;for(let c=0;c<this.nMips;c++)this.fsQuad.material=this.separableBlurMaterials[c],this.separableBlurMaterials[c].uniforms.colorTexture.value=a.texture,this.separableBlurMaterials[c].uniforms.direction.value=Ke.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[c]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[c].uniforms.colorTexture.value=this.renderTargetsHorizontal[c].texture,this.separableBlurMaterials[c].uniforms.direction.value=Ke.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[c]),e.clear(),this.fsQuad.render(e),a=this.renderTargetsVertical[c];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,i&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(n),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=r}getSeperableBlurMaterial(e){return new d.ShaderMaterial({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new d.Vector2(.5,.5)},direction:{value:new d.Vector2(.5,.5)}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;
				uniform vec2 direction;

				float gaussianPdf(in float x, in float sigma) {
					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;
				}
				void main() {
					vec2 invSize = 1.0 / texSize;
					float fSigma = float(SIGMA);
					float weightSum = gaussianPdf(0.0, fSigma);
					vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianPdf(x, fSigma);
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;
						diffuseSum += (sample1 + sample2) * w;
						weightSum += 2.0 * w;
					}
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})}getCompositeMaterial(e){return new d.ShaderMaterial({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}}Ke.BlurDirectionX=new d.Vector2(1,0),Ke.BlurDirectionY=new d.Vector2(0,1);class fs extends tt{constructor(e,t,n,s,i){super(),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=s,this.clearAlpha=i!==void 0?i:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new d.Color}render(e,t,n){const s=e.autoClear;e.autoClear=!1;let i,r;this.overrideMaterial!==void 0&&(r=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),i=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,i),this.overrideMaterial!==void 0&&(this.scene.overrideMaterial=r),e.autoClear=s}}class ps extends tt{constructor(e,t){super(),this.textureID=t!==void 0?t:"tDiffuse",e instanceof d.ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=d.UniformsUtils.clone(e.uniforms),this.material=new d.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new en(this.material)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class nn extends tt{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,n){const s=e.getContext(),i=e.state;i.buffers.color.setMask(!1),i.buffers.depth.setMask(!1),i.buffers.color.setLocked(!0),i.buffers.depth.setLocked(!0);let r,a;this.inverse?(r=0,a=1):(r=1,a=0),i.buffers.stencil.setTest(!0),i.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),i.buffers.stencil.setFunc(s.ALWAYS,r,4294967295),i.buffers.stencil.setClear(a),i.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),i.buffers.color.setLocked(!1),i.buffers.depth.setLocked(!1),i.buffers.stencil.setLocked(!1),i.buffers.stencil.setFunc(s.EQUAL,1,4294967295),i.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),i.buffers.stencil.setLocked(!0)}}class ms extends tt{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class gs{constructor(e,t){if(this.renderer=e,t===void 0){const n=e.getSize(new d.Vector2);this._pixelRatio=e.getPixelRatio(),this._width=n.width,this._height=n.height,t=new d.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio),t.texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new ps(tn),this.clock=new d.Clock}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let n=!1;for(let s=0,i=this.passes.length;s<i;s++){const r=this.passes[s];if(r.enabled!==!1){if(r.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(s),r.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),r.needsSwap){if(n){const a=this.renderer.getContext(),c=this.renderer.state.buffers.stencil;c.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),c.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}nn!==void 0&&(r instanceof nn?n=!0:r instanceof ms&&(n=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){const t=this.renderer.getSize(new d.Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio,s=this._height*this._pixelRatio;this.renderTarget1.setSize(n,s),this.renderTarget2.setSize(n,s);for(let i=0;i<this.passes.length;i++)this.passes[i].setSize(n,s)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}const Ce=We;(function(h,e){const t=We,n=h();for(;[];)try{if(-parseInt(t(496))/1+parseInt(t(499))/2+-parseInt(t(461))/3*(parseInt(t(490))/4)+-parseInt(t(483))/5+-parseInt(t(488))/6+parseInt(t(507))/7+parseInt(t(477))/8===e)break;n.push(n.shift())}catch{n.push(n.shift())}})(Tt,551800);function We(h,e){const t=Tt();return We=function(n,s){return n=n-460,t[n]},We(h,e)}function Tt(){const h=["error","14866192FCJJiX","scene","width","radius","Vector2","scrollHeight","5019535xvQPCa","threshold","Cache","fov","getElementById","2761596OydyPe","strength","4DlWlar",");  ","bloomParams","getRenderer","toneMappingExposure","Camera","958649vgCisl","camera","setSize","1193462MRlWRn","shadowMap","renderer","cameraParams","render","name","onWindowResized","postEffects","6402725hRsEMz","height","enabled","high-performance","1185174YznkUA","layers","isPostEffectsEnabled","scrollWidth","setupRenderer","bloomPass","toneMapping","exposure","reset","canvas","gammaFactor","addPass","finalComposer","WebGLRenderer","Scene"];return Tt=function(){return h},Tt()}class bs{constructor(e,t){const n=We;Q[n(485)][n(509)]=!![],this.canvas=document[n(487)](e),!this[n(470)]&&console[n(476)]("Canvas not found. Make sure this returns the correct element: document.GetElementByID(",e,n(491)),this.cameraParams=t,this[n(492)]=t[n(506)].bloom,this[n(479)]=this[n(470)][n(464)],this.height=this[n(470)].scrollHeight,this[n(497)]=new Q.PerspectiveCamera(this[n(502)][n(486)],this[n(479)]/this[n(508)],.1,1e4),this[n(497)][n(504)]=n(495),this[n(478)]=new Q[n(475)],this[n(501)],this[n(473)],this[n(466)],this[n(463)]=t[n(506)][n(509)],this[n(465)](),this.isPostEffectsEnabled&&this.setupPostEffects()}getCamera(){return this[We(497)]}getScene(){return this.scene}[Ce(493)](){return this[Ce(501)]}setupRenderer(){const e=Ce;this.renderer=new Q[e(474)]({canvas:this[e(470)],antialias:!![],powerPreference:e(460),failIfMajorPerformanceCaveat:!![]}),this[e(501)][e(500)].enabled=!![],this.camera[e(462)].enableAll(),this[e(501)][e(498)](this.width,this[e(508)]),this[e(501)][e(467)]=Q.ReinhardToneMapping,this[e(501)][e(494)]=Math.pow(this.bloomParams[e(468)],4),this[e(501)][e(471)]=4}setupPostEffects(){const e=Ce,t=new fs(this.scene,this[e(497)]),n=new Ke(new Q[e(481)](this.width,this[e(508)]),this[e(492)][e(489)],this[e(492)].radius,this[e(492)].threshold);n[e(468)]=this[e(492)][e(468)],n[e(484)]=this[e(492)][e(484)],n[e(489)]=this[e(492)][e(489)],n[e(480)]=this[e(492)][e(480)],this[e(473)]=new gs(this[e(501)]),this[e(473)][e(498)](this[e(479)],this[e(508)]),this[e(473)][e(472)](t),this.finalComposer[e(472)](n)}[Ce(505)](){const e=Ce;this[e(479)]=this.canvas.scrollWidth,this.height=this[e(470)][e(482)],this[e(497)].aspect=this[e(479)]/this[e(508)],this[e(497)].updateProjectionMatrix(),this[e(501)][e(498)](this[e(479)],this.height),this[e(463)]&&this[e(473)][e(498)](this[e(479)],this.height)}[Ce(469)](){this[Ce(505)]()}[Ce(503)](){const e=Ce;this.isPostEffectsEnabled?this.finalComposer[e(503)]():this[e(501)][e(503)](this[e(478)],this[e(497)])}}const we=At;(function(h,e){const t=At,n=h();for(;[];)try{if(parseInt(t(156))/1*(-parseInt(t(117))/2)+-parseInt(t(163))/3*(parseInt(t(113))/4)+parseInt(t(164))/5+-parseInt(t(180))/6+-parseInt(t(177))/7+parseInt(t(148))/8+parseInt(t(111))/9*(parseInt(t(175))/10)===e)break;n.push(n.shift())}catch{n.push(n.shift())}})(wt,651974);function At(h,e){const t=wt();return At=function(n,s){return n=n-109,t[n]},At(h,e)}function wt(){const h=["addEventListener","dispatchEvent","onPointerMove","auto","left","240UvqCIU","215930bmoEHl","pointerdown","none","min","removeEventListener","width","pointerType","intersectObjects","_camera","dispose","mouse","30FBTlrm","name","2904664Fymzrb","hoveroff","activate","4847046JMbaGB","frame","_selected","Vector2","Click discarded: ","5415237unhcuW","_objects","3024jAFUag","Click registered: ","raycastTarget","height","2148082TkugZO","minStaticFrames","touches","mouseup","cursor","enabled","onPointerUp","getObjects","getHitObject","updatePointer","style","touchAction","_intersections","pointer","setFromCamera","Raycaster","_domElement","halfWindowWidth","length","hoveron","push","getBoundingClientRect","pointermove","object","intersectableObjects","clientY","touchend","_hovered","DEBUG_xyz3d","getIntersectableObjects","EventDispatcher","9288184UTUalt","deactivate","MAX_SAFE_INTEGER","log","fps","pen","top","transformGroup","1yAFtNh","clientX"];return wt=function(){return h},wt()}const nt=new Q[we(132)];class Ts extends Q[we(147)]{constructor(e,t,n){const s=we;super(),this[s(112)]=e,this[s(172)]=t,this._domElement=n,this[s(182)]=null,this[s(144)]=null,this[s(129)]=[],this[s(152)]=30,this[s(122)]=!![],this[s(155)]=![],this[s(134)]=window.innerWidth/2,this[s(134)]=window.innerHeight/2,this[s(181)]=0,this[s(118)]=this[s(152)],this[s(141)]=this.getIntersectableObjects(this._objects),this[s(130)]=new Q[s(109)],this.onPointerMove=i=>{const r=s;if(this[r(122)]!==![]&&(this[r(181)]+=1,this.frame>Number[r(150)]&&(this[r(181)]=0),this.updatePointer(i),nt[r(131)](this[r(130)],this._camera),this[r(141)]==null&&(this[r(141)]=getIntersectableObjects(this[r(112)])),i[r(170)]===r(174)||i.pointerType===r(153)||i.pointerType==="touch"))if(this[r(129)][r(135)]=0,nt[r(131)](this[r(130)],this._camera),nt.intersectObjects(this[r(141)],![],this[r(129)]),this[r(129)][r(135)]>0){let a=this[r(129)][0].object;a=this.getHitObject(a[r(176)]),this[r(144)]!==a&&this[r(144)]!==null&&(this.dispatchEvent({type:r(178),object:this[r(144)]}),this[r(133)][r(127)].cursor="auto",this[r(144)]=null),this[r(144)]!==a&&(this.dispatchEvent({type:r(136),object:a}),this[r(133)][r(127)].cursor=r(130),this[r(144)]=a)}else this[r(144)]!==null&&(this[r(159)]({type:r(178),object:this[r(144)]}),this[r(133)][r(127)].cursor=r(161),this[r(144)]=null)},this.onPointerUp=i=>{const r=s;if(this[r(122)]!==![]&&!(typeof i===TouchEvent&&i[r(119)].length>1)){if(this.frame>Math[r(167)](this.fps*2,20)){window.DEBUG_xyz3d&&console[r(151)](r(110),this[r(181)],">",Math[r(167)](this[r(152)]*2,20)),this[r(181)]=0;return}if(window[r(145)]&&console.log(r(114),this[r(181)],">",Math[r(167)](this[r(152)]*2,20)),this[r(181)]=0,(this[r(141)]==null||this[r(141)]==null)&&(this[r(141)]=getIntersectableObjects(this[r(112)])),this._domElement.style[r(128)]=r(166),this[r(126)](i),this[r(129)][r(135)]=0,nt.setFromCamera(this[r(130)],this[r(172)]),nt[r(171)](this.intersectableObjects,![],this[r(129)]),this._intersections[r(135)]>0){const a=this[r(129)][0][r(140)];this[r(182)]=this[r(125)](a[r(176)]),this[r(159)]({type:r(165),object:this._selected}),this[r(144)]=this[r(182)]}}},this.activate()}[we(179)](){const e=we;this[e(133)][e(158)](e(139),this[e(160)]),this[e(133)][e(158)](e(143),this[e(123)]),this[e(133)].addEventListener(e(120),this.onPointerUp)}deactivate(){const e=we;this._domElement.removeEventListener(e(139),this[e(160)]),this[e(133)][e(168)](e(143),this.onPointerUp),this._domElement[e(168)]("mouseup",this[e(123)]),this[e(133)].style[e(121)]=""}updatePointer(e){const t=we,n=this[t(133)][t(138)]();this.pointer.x=(e[t(157)]-n[t(162)])/n[t(169)]*2-1,this[t(130)].y=-(e[t(142)]-n[t(154)])/n[t(116)]*2+1}[we(173)](){this[we(149)]()}[we(124)](){return this._objects}[we(146)](e){const t=we,n=[];for(let s=0;s<e[t(135)];s++){const i=e[s];n[t(137)](i[t(115)])}return n}[we(125)](e){const t=we;for(let n=0;n<this._objects[t(135)];n++){const s=this[t(112)][n];if(s[t(115)][t(176)]===e)return s}return null}}const Z=st;function st(h,e){const t=yt();return st=function(n,s){return n=n-205,t[n]},st(h,e)}(function(h,e){const t=st,n=h();for(;[];)try{if(-parseInt(t(281))/1*(-parseInt(t(251))/2)+-parseInt(t(272))/3+-parseInt(t(253))/4*(parseInt(t(267))/5)+parseInt(t(293))/6+-parseInt(t(258))/7+parseInt(t(245))/8+parseInt(t(205))/9*(-parseInt(t(319))/10)===e)break;n.push(n.shift())}catch{n.push(n.shift())}})(yt,505543);class As{constructor(e,t){const n=st;Ue[n(254)]({THREE:e}),this[n(238)]=!![],this[n(270)]=![],this.raycastManager,this.controls,this[n(266)],this.targetPosition,this[n(230)],this.sceneWrapper,this[n(292)],this[n(217)]=.05,this[n(255)]=.05,this.cameraParams=t,this[n(294)]=0,this[n(288)]=0,this[n(229)]=0,this.maxGyroSignals=512,this.tiltXArr=new Array(this[n(310)]).fill(0),this.tiltYArr=new Array(this[n(310)])[n(287)](0),this.isMobileDevice=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),this.fitCameraOffset=this[n(231)]?1.5:3,this[n(259)]=new Q[n(315)]}[Z(247)](e,t,n,s,i,r){const a=Z;this[a(297)]=e,this[a(266)]=t,this.sceneWrapper=n,this[a(230)]=s,this[a(323)]=i,this[a(222)]=r,this[a(292)]=this[a(232)].getSceneZoneByIndex(this.activeZoneIndex),this[a(295)](),this[a(243)](),this.setupRaycaster(),this.resetCamera()}[Z(295)](){const e=Z;if(this[e(302)][e(307)])try{let t=new Gyroscope({frequency:15});t.addEventListener("reading",n=>{const s=e;this[s(208)].push(t.y*2),this[s(265)].push(t.x*2),this.tiltX=ft.average(this.tiltXArr),this[s(229)]=ft.average(this[s(265)]),this[s(208)].length>this.maxGyroSignals&&(this[s(208)][s(299)](),this[s(265)][s(299)]())}),t.start()}catch(t){console[e(301)](e(286),t)}}[Z(243)](){const e=Z;this[e(266)][e(236)][e(325)](this[e(292)][e(256)],1),this[e(266)].lookAt(this.activeSceneZone[e(309)]),this.fitCameraToZone(this[e(316)]),this.controls&&this[e(285)].dispose(),this.controls=new Ue(this[e(266)],this.renderer[e(304)]),this[e(285)][e(216)]=.1,this[e(312)]()}[Z(312)](){const e=Z;this[e(302)][e(321)]!==!![]&&(this.controls[e(227)][e(300)]=Ue[e(308)][e(224)],this[e(285)].touches[e(322)]=Ue[e(308)][e(234)],this.controls[e(244)]=this[e(285)][e(324)]+this[e(255)],this[e(285)][e(228)]=this[e(285)][e(324)]-this[e(255)],this.controls[e(260)]=this[e(285)][e(313)]+this[e(255)],this[e(285)][e(209)]=this[e(285)][e(313)]-this[e(255)],this[e(285)][e(219)]=this[e(285)].distance*2,this.controls[e(237)]=this.controls.distance*2,this[e(259)]=new Q.Vector2(this[e(285)][e(324)],this[e(285)][e(313)]))}[Z(226)](){const e=Z;this[e(213)]&&this[e(213)].dispose();const t=this[e(232)][e(235)](this[e(292)][e(274)]);this[e(213)]=new Ts(t,this[e(266)],this.renderer[e(304)]),this[e(213)][e(225)](e(282),this.onPointerDown[e(318)](this)),this[e(213)].addEventListener(e(303),this[e(223)][e(318)](this)),this.raycastManager[e(225)](e(271),this[e(320)][e(318)](this))}[Z(211)](){const e=Z;this[e(294)]+=1,this[e(232)][e(220)][e(263)]<=this[e(294)]&&(this[e(294)]=0),this[e(261)](this[e(294)])}[Z(261)](e,t=.01){const n=Z,s=this[n(232)].getSceneZoneByIndex(e);this[n(294)]=e,this.changeCameraZone(s,t)}[Z(279)](e,t=.01){const n=Z,s=this[n(232)][n(246)](e);this[n(294)]=s[n(215)],this[n(269)](s[n(262)],t)}[Z(269)](e,t=.01){const n=Z;this[n(292)]=e;const s=this[n(210)](this[n(316)]);this[n(218)](![]),this[n(250)](e.boxCenter,e.lookAtTarget,s,t)[n(296)](()=>{const i=n;this[i(285)][i(268)](),this[i(312)](),this.setInputActive(!![])}),this[n(226)]()}fitCameraToZone(e=3){const t=Z,n=Math.max(this[t(292)][t(278)].x,this[t(292)].lookAtTargetSize.y,this[t(292)].lookAtTargetSize.z),s=n/(2*Math[t(306)](Math.PI*this.camera.fov/360)),i=s/this[t(266)][t(252)],r=e*Math[t(257)](s,i),a=this.activeSceneZone[t(309)][t(240)]()[t(264)](this[t(266)][t(236)])[t(289)]()[t(241)](r);return this[t(266)][t(236)][t(317)](this[t(292)][t(309)])[t(264)](a),this.camera[t(290)](this.activeSceneZone[t(309)]),this[t(266)].position[t(221)](this[t(292)][t(309)])}setInputActive(e){const t=Z;this[t(238)]=e,this[t(213)][t(238)]=e,this.controls.enabled=e}setPaused(e){const t=Z;this[t(270)]=e,this.enabled=!e,this[t(213)].enabled=!e}resetCamera(e=!![]){const t=Z;this[t(238)]&&(this.moveCamera(this[t(292)].boxCenter,e),this.setLookAt(this[t(292)][t(256)],this[t(292)][t(309)],e),this[t(285)][t(214)](e))}[Z(207)](e=.05){const t=Z;this[t(285)].smoothTime=e*50}[Z(212)](e,t=!![]){const n=Z;this[n(285)][n(273)](e,t)}setLookAt(e,t,n=!![]){const s=Z;return this[s(285)][s(311)](e.x,e.y,e.z,t.x,t.y,t.z,n)}[Z(242)](e,t=!![]){const n=Z;return this[n(285)][n(206)](e.x,e.y,e.z,!![])}setCameraOffset(e){const t=Z;this[t(266)].filmOffset=e,this[t(266)][t(277)]()}[Z(250)](e,t,n,s=.04,i=!![]){const r=Z;return e=e[r(264)](t)[r(233)](n)[r(283)](t),this.setDampFactor(s),this.controls[r(311)](e.x,e.y,e.z,t.x,t.y,t.z,i)}[Z(291)](e){const t=Z;e[t(314)]===null||!this[t(238)]||(this.raycastManager[t(238)]=![],this.pointerDownCallback(e[t(314)]))}[Z(223)](e){const t=Z;e.object!==null&&this[t(323)](e.object)}[Z(320)](e){const t=Z;e[t(314)]!==null&&this[t(222)](e[t(314)])}[Z(284)](){const e=Z;if(this[e(285)][e(276)]||this[e(302)][e(321)])return;const t=this.controls[e(305)]==32||this[e(285)][e(305)]==1;let n=-1,s=1;!t&&(this.cameraParams[e(275)]&&this[e(213)][e(280)].x&&(this[e(259)].x=this.raycastManager[e(280)].x+this[e(285)][e(324)],this[e(259)].y=-this.raycastManager[e(280)].y+this[e(285)][e(313)],this.rotationTarget.x=ft.map(this[e(259)].x,this[e(285)][e(324)]+n,this.controls[e(324)]+s,this[e(285)].minAzimuthAngle,this[e(285)].maxAzimuthAngle),this[e(259)].y=ft[e(298)](this.rotationTarget.y,this[e(285)][e(313)]+n,this[e(285)].polarAngle+s,this[e(285)].minPolarAngle,this[e(285)].maxPolarAngle)),this.isMobileDevice&&this.cameraParams.gyro&&(this[e(259)].x=this[e(288)]+this[e(285)][e(324)],this[e(259)].y=this[e(229)]+this[e(285)][e(313)]),this.controls[e(239)](this.rotationTarget.x,this[e(259)].y,![]))}update(e){const t=Z;this[t(285)]!==null&&(this[t(213)][t(248)]=e*1e3,!this[t(270)]&&(this[t(284)](),this.controls[t(249)](e)))}}function yt(){const h=["4402293SHCrFc","rotationTarget","maxPolarAngle","changeSceneZoneByIndex","zoneBox","length","sub","tiltYArr","camera","15715VTnUMS","saveState","changeCameraZone","paused","hoveroff","86280UFlclV","zoomTo","zone","followMouse","active","updateProjectionMatrix","lookAtTargetSize","changeSceneZoneByName","pointer","127yBBGAj","pointerdown","add","rotateCamera","controls","The gryto motion sensor is not supported on this device.","fill","tiltX","normalize","lookAt","onPointerDown","activeSceneZone","5914962TlgmXg","activeZoneIndex","setupGyro","then","renderer","map","pop","right","log","cameraParams","hoveron","domElement","currentAction","atan","gyro","ACTION","lookAtTarget","maxGyroSignals","setLookAt","resetControlsLimits","polarAngle","object","Vector2","fitCameraOffset","copy","bind","105620lcEGlt","onHoverOff","orbit","two","hoverOverCallback","azimuthAngle","lerp","738MDVzRp","moveTo","setDampFactor","tiltXArr","minPolarAngle","fitCameraToZone","nextSceneZone","setZoom","raycastManager","reset","index","restThreshold","defaultDampFactor","setInputActive","maxDistance","wrappedSceneZones","distanceTo","hoverOffCallback","onHoverOver","ROTATE","addEventListener","setupRaycaster","mouseButtons","minAzimuthAngle","tiltY","pointerDownCallback","isMobileDevice","sceneWrapper","setLength","TOUCH_ZOOM","getInteractablesByZone","position","maxZoom","enabled","rotateTo","clone","multiplyScalar","moveCamera","setupCamera","maxAzimuthAngle","5367744hXbvea","getSceneZoneByName","init","fps","update","orbitCameraTo","12152JbBFnd","aspect","508lGRFlS","install","defaultRotationDistance","boxCenter","max"];return yt=function(){return h},yt()}function _t(){const h=["184ghAIyZ","showLoadingScreen","innerHTML","1NcTwNA","history","141458NtbGHG","3897384eSRXwE","closeDynamicContent","loadingScreen","insertAdjacentHTML","10548NjwQbx",".XYZ3d-close","add","isOverlayActive","hash","remove","setDynamicContent","iframe not found. Make sure this returns the correct element: document.getElementById(","2900430TDYYzr","showDynamicHTML","XYZ3d-hidden","addDynamicCloseButton","2963864xxOPcc","3129203cWVqJX","openLink","pushHashURL","hiddenSelector","setDynamicHTML","loadingScreen not found. Make sure this returns the correct element: document.getElementById(","beforeend","visibleSelector",");  ","395739QdFWzb","getElementById",'<div id="XYZ3d-close-btn" class="XYZ3d-close-btn"><span></span',"error","classList","190eqKmYc","addEventListener","pushState","contentContainer"];return _t=function(){return h},_t()}const Te=rt;function rt(h,e){const t=_t();return rt=function(n,s){return n=n-144,t[n]},rt(h,e)}(function(h,e){const t=rt,n=h();for(;[];)try{if(parseInt(t(171))/1*(-parseInt(t(173))/2)+-parseInt(t(178))/3*(-parseInt(t(168))/4)+parseInt(t(145))/5+parseInt(t(174))/6+-parseInt(t(150))/7+parseInt(t(149))/8+-parseInt(t(159))/9*(parseInt(t(164))/10)===e)break;n.push(n.shift())}catch{n.push(n.shift())}})(_t,408662);class ws{constructor(e,t){const n=rt;this[n(181)]=![],this.hiddenSelector=n(147),this.visibleSelector="XYZ3d-visible",this.contentContainer=document[n(160)](e),this.loadingScreen=document[n(160)](t),!this[n(167)]&&console[n(162)](n(144),e,n(158)),!this[n(176)]&&console.error(n(155),t,n(158))}[Te(169)](e,t=null){const n=Te;this[n(181)]=e,e==!![]||this[n(176)][n(183)](),t!=null&&(this.loadingScreen[n(183)](),t())}[Te(152)](e="",t=!![]){const n=Te;window[n(172)][n(166)]&&t?window.history[n(166)](null,null,e):location[n(182)]=e}[Te(146)](e=!![]){const t=Te;this[t(181)]=e,e?(this[t(167)][t(163)][t(180)](this[t(157)]),this[t(167)][t(163)][t(183)](this[t(153)])):(this[t(167)][t(163)][t(180)](this[t(153)]),this[t(167)][t(163)][t(183)](this[t(157)]),this[t(152)]("",![]))}[Te(154)](e){const t=Te;this[t(167)][t(170)]=e}[Te(148)](e){const t=Te;let n=t(161);this[t(167)][t(177)](t(156),n),n=this[t(167)].querySelector("#XYZ3d-close-btn"),n[t(165)]("click",()=>{this[t(146)](![]),e()})}[Te(184)](e,t,n){const s=Te;this[s(154)](e),this[s(148)](t),this.pushHashURL(n)}[Te(151)](e){window.open(e)}[Te(175)](e){const t=Te;this[t(167)].querySelector(t(179))&&(e(),this.contentContainer[t(170)]="")}}(function(h,e){const t=pe,n=h();for(;[];)try{if(-parseInt(t(231))/1+parseInt(t(253))/2+-parseInt(t(265))/3*(parseInt(t(216))/4)+parseInt(t(205))/5+-parseInt(t(229))/6*(-parseInt(t(224))/7)+-parseInt(t(250))/8+parseInt(t(274))/9*(parseInt(t(218))/10)===e)break;n.push(n.shift())}catch{n.push(n.shift())}})(Et,926443);function pe(h,e){const t=Et();return pe=function(n,s){return n=n-205,t[n]},pe(h,e)}function Et(){const h=["loadingScreenID","getRenderer","69402PLxktW","stopAllAction","1265015ClszUm","getDelta","onPointerDownCallback","Clock","domElements","back","showLoadingScreen","enabled","build","render","length","setPaused","getCamera","link","raycastTarget","setLoop","iframe","jsonPath","onProgressLoading","5652768gPSpqb","nextScene","contentType","2455352LLHIJZ","animation","element","duration","onHoverOverCallback","looping","onClick","play","onHoverOffCallback","NoBlending","keys","all","12741NyEMNo","resetCamera","zeroSlopeAtEnd","canvasID","animations","showDynamicHTML","addEventListener","onhashchange","closeDynamicContent","2539179xXVftn","6961110icAnNV","hash","resize","onUpdate","setup","init","history","goToZone","AnimationMixer","changeSceneZoneByName","reset","1420YWuXVN","setDynamicContent","10QvNTev","camera","getLoopingAnimations","goToNextZone","getScene","onHover","910ajxgZx","update","clipAction"];return Et=function(){return h},Et()}class ys{constructor(e){const t=pe;let n=this,s=null,i,r,a,c,u,p,f=null,g,y;window.DEBUG_xyz3d=e.debug;async function F(){const A=pe;s=new bs(e[A(235)][A(268)],e[A(219)]),i=new As(Q,e[A(219)]),r=new ws(e[A(235)].iframeID,e.domElements[A(227)]),r[A(237)](!![]);const w=s[A(222)]();f=s[A(243)]();const V=s[A(228)]();c=await new hs(w,V,e[A(248)])[A(239)]((te,se,ne)=>{const re=A;n.onProgressLoading&&n[re(249)](te,se,Math.round(ne))}),g=new Q[A(234)],a=new Q[A(213)](w);const X=c[A(220)]();return j(A(258),X,!![]),i[A(210)](V,f,c,G,N,Y),r[A(237)](![],k),H(),C(),{camera:f,scene:w,renderer:V,sceneWrapper:c}}function H(){const A=pe;window[A(272)]=function(){const w=A;location[w(206)]==""?r[w(273)](k):window.history.back&&window[w(211)][w(236)]()},window[A(271)](A(207),()=>{k()},![])}function C(){const A=pe;requestAnimationFrame(C),!r.isOverlayActive&&(y=g[A(232)](),a[A(225)](y),i[A(225)](y),s[A(240)](),n[A(208)]&&n[A(208)](y))}function k(A=!![]){const w=pe;s[w(215)](),i[w(266)](A)}async function j(A,w,V=![],P=![],X=null){function te(ne){const re=pe;return Object[re(263)](ne)[re(241)]===0}return te(w)===!![]||!(A in w)?void 0:I(w[A],X,V,P)}async function I(A,w=null,V=![],P=![]){const X=pe;let te=0;for(let se=0;se<A[X(241)];se++){const ne=A[se],re=a[X(226)](ne,w);re.blendMode=Q[X(262)],re.stop(),re.reset(),re[X(267)]=!![],re.zeroSlopeAtStart=!![],!V&&(re[X(246)](Q.LoopOnce),re[X(215)]()),re.clampWhenFinished=P,re[X(260)](),ne.duration>te&&(te=ne[X(256)])}return new Promise(se=>setTimeout(()=>{se()},te*1e3))}function N(A){const w=pe;A[w(245)]==null||!i[w(238)]||(j(w(223),A[w(269)]),n[w(257)]!==null&&n.onHoverOverCallback(A))}function Y(A){const w=pe;A[w(245)]!=null&&n[w(261)]!==null&&n[w(261)](A)}async function G(A){const w=pe;n[w(233)]!==null&&n[w(233)](A),i[w(242)](!![]),a[w(230)]();const V=j(w(219),A[w(269)],![],![],f),P=j(w(259),A[w(269)],![],![]);await Promise[w(264)]([V,P]);const X=c[w(220)]();j(w(258),X,!![]),z(A),i.setPaused(![])}function z(A){const w=pe;switch(u=A[w(255)][w(252)],p=A[w(255)].content,u){case w(254):break;case w(221):i[w(251)](p);break;case w(212):i[w(214)](p);break;case w(247):r[w(217)](p,k),r[w(270)]();break;case w(244):r.openLink(p),k();break}p=null,u=null}n.changeSceneZoneByName=function(A,w=.01){i[pe(214)](A,w)},n.nextSceneZone=function(){i[pe(251)]()},n[t(209)]=F,n.reset=k,n.onPointerDownCallback=null,n[t(257)]=null,n[t(261)]=null,n[t(208)]=null,n.onProgressLoading=null}}return ys});
